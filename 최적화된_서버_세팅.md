ì¢‹ìŠµë‹ˆë‹¤. Cloudflareë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ìƒí™©ì´ë¼ë©´, Fly.ioì˜ Anycast ë„¤íŠ¸ì›Œí¬ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë˜ **Caddy ìì²´ ìºì‹± ë° aggressive ìºì‹œ í—¤ë” ì„¤ì •**ìœ¼ë¡œ Outbound Bandwidthë¥¼ ìµœëŒ€í•œ ì ˆê°í•´ì•¼ í•©ë‹ˆë‹¤.

ì•„ë˜ëŠ” ë‹¹ì‹ ì˜ í˜„ì¬ êµ¬ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ,
â€œìºì‹± ê·¹ëŒ€í™” + gzip/zstd ì••ì¶• + immutable ì •ì  íŒŒì¼ í—¤ë” + ETag/304 ì§€ì› + ìµœì†Œ ë¨¸ì‹  ìœ ì§€â€
ë“±ì„ ë°˜ì˜í•œ **ìµœì í™”ëœ `Caddyfile`**ê³¼ **`fly.toml`** ì˜ˆì‹œì…ë‹ˆë‹¤.

---

## ğŸ§± ìµœì í™”ëœ Caddyfile

```caddy
# Fly.ioì˜ ë‚´ë¶€ í¬íŠ¸(8080)
:8080

# Hugoê°€ ë¹Œë“œí•œ ì •ì  íŒŒì¼ ìœ„ì¹˜
root * /srv

# ì •ì  íŒŒì¼ ì„œë²„
file_server

# ì••ì¶• í™œì„±í™” (gzip, zstd ëª¨ë‘ ì‚¬ìš©)
encode gzip zstd

# ë¸Œë¼ìš°ì € ìºì‹œ ì •ì±… (1ë…„ ìœ ì§€, ë³€ê²½ ë¶ˆê°€ë¡œ í‘œì‹œ)
@static {
    path *.css *.js *.woff2 *.woff *.ttf *.svg *.png *.jpg *.jpeg *.gif *.ico *.webp *.avif *.pdf *.json
}
header @static Cache-Control "public, max-age=31536000, immutable"

# HTMLê³¼ XMLì€ ì§§ê²Œ ìºì‹œ (ë³€ê²½ ê°€ëŠ¥ì„± ìˆìœ¼ë¯€ë¡œ)
@html {
    path *.html *.xml
}
header @html Cache-Control "public, max-age=86400, stale-while-revalidate=604800"

# ê¸°íƒ€ MIME íƒ€ì… (ê¸°ë³¸ 1ì¼ ìºì‹œ)
header Cache-Control "public, max-age=86400"

# ETag ì§€ì› (ë³€ê²½ ì‹œ ìë™ 304 ë°˜í™˜)
etag

# ê¸°ë³¸ ë³´ì•ˆ í—¤ë” ì¶”ê°€
header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    Referrer-Policy "strict-origin-when-cross-origin"
    Content-Security-Policy "default-src 'self'; img-src 'self' data:;"
}
```

### ğŸ’¡ ì£¼ìš” ê°œì„ ì 

1. **ETag + immutable í—¤ë” ì¡°í•©**
   â†’ ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ì‹œ ìš”ì²­í•  ë•Œ Fly VMì´ ë°ì´í„°ë¥¼ ì¬ì „ì†¡í•˜ì§€ ì•ŠìŒ (304ë¡œ ì‘ë‹µ).
2. **ì••ì¶• í™œì„±í™”**
   â†’ í…ìŠ¤íŠ¸ ê¸°ë°˜ ìì‚°(css/js/html/json ë“±)ì˜ Outboundë¥¼ ìµœëŒ€ 70% ì ˆì•½.
3. **ì¥ê¸° ìºì‹œ (1ë…„)**
   â†’ ìì£¼ ë°”ë€Œì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ë¸Œë¼ìš°ì € ì¬ìš”ì²­ ë°©ì§€.
4. **Fly ë‚´ë¶€ ìºì‹œ(`fly-proxy` ìºì‹œ)**ë„ ìë™ìœ¼ë¡œ ë” ì˜¤ë˜ ë¨¸ë¬´ë¦„.

---

## âš™ï¸ ìµœì í™”ëœ fly.toml

```toml
# fly.toml configuration file for mycodings
app = "mycodings"
primary_region = "nrt"  # ë„ì¿„ ë¦¬ì „

[build]

[env]
  PORT = "8080"

[http_service]
  internal_port = 8080
  force_https = true
  auto_stop_machines = "stop"
  auto_start_machines = true

  # ìµœì†Œ í•˜ë‚˜ì˜ ë¨¸ì‹ ì€ í•­ìƒ ì¼œë‘ì–´ cold-startë¡œ ì¸í•œ ì¤‘ë³µ ìš”ì²­ ë°©ì§€
  min_machines_running = 1

  # Keep-alive ì„¤ì • (Edge proxyê°€ VMê³¼ ì—°ê²° ìœ ì§€)
  processes = ["app"]

  # HTTP Keepaliveì™€ ê´€ë ¨ëœ íƒ€ì„ì•„ì›ƒ ì™„í™”
  [http_service.concurrency]
    type = "connections"
    hard_limit = 1000
    soft_limit = 800

[[vm]]
  size = "shared-cpu-1x"  # ì €ë¹„ìš© VM
  memory_mb = 256
  cpu_kind = "shared"
```

---

## ğŸ§  ì¶”ê°€ ê¶Œì¥ ì‚¬í•­

### 1. `auto_stop_machines = "stop"` ìœ ì§€ ì´ìœ 

íŠ¸ë˜í”½ì´ ì—†ì„ ë•Œ ì •ì§€ì‹œí‚¤ëŠ” ê±´ ì—¬ì „íˆ ìœ íš¨í•©ë‹ˆë‹¤.
í•˜ì§€ë§Œ `min_machines_running = 1` ë•ë¶„ì— â€œì²« ìš”ì²­ì´ ëŠë¦¬ê±°ë‚˜ ë‘ ë²ˆ ë°œìƒâ€í•˜ëŠ” ë¬¸ì œë¥¼ ì™„í™”í•©ë‹ˆë‹¤.

### 2. Outbound ê°ì†Œ íš¨ê³¼

| ìµœì í™” í•­ëª©           | ì˜ˆìƒ ì ˆê° íš¨ê³¼               |
| ---------------- | ---------------------- |
| gzip/zstd ì••ì¶•     | í…ìŠ¤íŠ¸ ìì‚° 60~80% ì ˆê°       |
| Cache-Control í—¤ë” | ë°˜ë³µ ë°©ë¬¸ ì‹œ 90% ì´ìƒ ì ˆê°      |
| ETag + 304 ì‘ë‹µ    | Fly ë‚´ë¶€ íŠ¸ë˜í”½ ì•½ 30~50% ì ˆê° |
| immutable ìì‚°     | ì „ì†¡ ìì²´ íšŒí”¼ (0 outbound)  |

ğŸ‘‰ ì¢…í•©ì ìœ¼ë¡œ **30GB ê¸°ì¤€ íŠ¸ë˜í”½ì˜ 80~95% ê°ì†Œ**ê°€ ê¸°ëŒ€ë©ë‹ˆë‹¤.

### 3. ìºì‹œ ë¬´íš¨í™” ì „ëµ

íŒŒì¼ëª…ì„ Hugo ë¹Œë“œ ì‹œ í•´ì‹œ ê¸°ë°˜(`{{ resources.Fingerprint }}`)ìœ¼ë¡œ ìƒì„±í•˜ë©´,
immutable ìºì‹œë¥¼ ì¨ë„ ê°±ì‹  ì‹œ ìë™ ë°˜ì˜ë©ë‹ˆë‹¤.

---

## ğŸš€ ì •ë¦¬

| í•­ëª©          | ì¡°ì¹˜ ë‚´ìš©                                 |
| ----------- | ------------------------------------- |
| CDN ì‚¬ìš© ë¶ˆê°€   | Caddy + Fly proxyë§Œìœ¼ë¡œ ìºì‹œ ìµœì í™”           |
| ì£¼ìš” ê°œì„        | ì••ì¶•, Cache-Control, ETag, immutable ì ìš© |
| fly.toml ê°œì„  | min_machines_running=1, ì—°ê²° ìœ ì§€         |
| íš¨ê³¼          | Outbound ë¹„ìš© ìµœëŒ€ 90% ì ˆê° ì˜ˆìƒ              |

---

ì›í•˜ì‹ ë‹¤ë©´ ìœ„ ì„¤ì •ì„ ê¸°ë°˜ìœ¼ë¡œ **Hugoì˜ `config.toml`ì—ì„œ fingerprint í•´ì‹œ ì ìš© ì˜ˆì‹œ**ë„ í•¨ê»˜ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê·¸ë ‡ê²Œ í•´ì„œ ìºì‹œ ë¬´íš¨í™”ê¹Œì§€ ìë™í™”í• ê¹Œìš”?
