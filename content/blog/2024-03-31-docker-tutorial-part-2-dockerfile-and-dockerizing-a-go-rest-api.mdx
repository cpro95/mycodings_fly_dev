---
slug: 2024-03-31-docker-tutorial-part-2-dockerfile-and-dockerizing-a-go-rest-api
title: ë„ì»¤ íŠœí† ë¦¬ì–¼ 2ë¶€. Goë¡œ ë§Œë“  REST APIë¥¼ Dockerfile ì´ìš©í•´ì„œ ë„ì»¤ì— ë„£ê¸°
date: 2024-03-31T02:28:27.457Z
description: ë„ì»¤ ë§ˆìŠ¤í„°í•˜ê¸° ì‹œë¦¬ì¦ˆì…ë‹ˆë‹¤. 2í¸ Dockerfile ì‚´í´ë³´ê¸°
meta:
  keywords:
    - go
    - golang
    - rest api
    - dockerfile
published: true
---

# ë„ì»¤ íŠœí† ë¦¬ì–¼ 2ë¶€: Goë¡œ ë§Œë“  REST APIë¥¼ Dockerfile ì´ìš©í•´ì„œ ë„ì»¤ì— ë„£ê¸°

ì•ˆë…•í•˜ì„¸ìš”?

ë„ì»¤ íŠœí† ë¦¬ì–¼ ì‹œë¦¬ì¦ˆ 2ë²ˆì§¸ì…ë‹ˆë‹¤.

ì˜¤ëŠ˜ì€ 1í¸ì—ì„œ ë°°ìš´ ë„ì»¤ ê¸°ì´ˆë¥¼ ë°”íƒ•ìœ¼ë¡œ Dockerfileì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

Dockerfileì€ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì‰½ê²Œ ë§Œë“¤ì–´ ì£¼ëŠ” íŒŒì¼ì¸ë°ìš”.

ì˜¤ëŠ˜ì€ Go ì–¸ì–´ë¡œ ì‘ì„±í•œ REST APIë¥¼ Dockerfileì„ ì´ìš©í•´ì„œ ë„ì»¤ì— ë„£ì–´ ì‹¤í–‰ì‹œì¼œ ë³´ê² ìŠµë‹ˆë‹¤.

ì „ì²´ ê°•ì¢Œë¦¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.

1. [ë„ì»¤ íŠœí† ë¦¬ì–¼ 1ë¶€: ë„ì»¤ ê¸°ì´ˆ ë‹¤ì§€ê¸°](https://mycodings.fly.dev/blog/2024-03-30-docker-tutorial-part-1-getting-started-with-docker)

2. [ë„ì»¤ íŠœí† ë¦¬ì–¼ 2ë¶€: Goë¡œ ë§Œë“  REST APIë¥¼ Dockerfile ì´ìš©í•´ì„œ ë„ì»¤ì— ë„£ê¸°](https://mycodings.fly.dev/blog/2024-03-31-docker-tutorial-part-2-dockerfile-and-dockerizing-a-go-rest-api)

---

** ëª© ì°¨ **

- [ë„ì»¤ íŠœí† ë¦¬ì–¼ 2ë¶€: Goë¡œ ë§Œë“  REST API Dockerfile ì´ìš©í•´ì„œ ë„ì»¤ì— ë„£ê¸°](#ë„ì»¤-íŠœí† ë¦¬ì–¼-2ë¶€-goë¡œ-ë§Œë“ -rest-api-dockerfile-ì´ìš©í•´ì„œ-ë„ì»¤ì—-ë„£ê¸°)
	- [Go REST API ì‘ì„±í•˜ê¸°](#go-rest-api-ì‘ì„±í•˜ê¸°)
	- [Dockerfile ì´ë€?](#dockerfile-ì´ë€)
	- [dockerignore íŒŒì¼](#dockerignore-íŒŒì¼)
	- [ë„ì»¤ ì´ë¯¸ì§€ ë§Œë“¤ê¸°](#ë„ì»¤-ì´ë¯¸ì§€-ë§Œë“¤ê¸°)
	- [ë„ì»¤ ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°](#ë„ì»¤-ì´ë¯¸ì§€-ì‹¤í–‰í•˜ê¸°)
	- [Dockerfileì— ì‹¤í–‰ ì½”ë“œê¹Œì§€ ë„£ê¸°](#dockerfileì—-ì‹¤í–‰-ì½”ë“œê¹Œì§€-ë„£ê¸°)
	- [DockerHubì— ì´ë¯¸ì§€ ì˜¬ë ¤ë³´ê¸°](#dockerhubì—-ì´ë¯¸ì§€-ì˜¬ë ¤ë³´ê¸°)

---

## Go REST API ì‘ì„±í•˜ê¸°

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë¨¼ì € Go ì–¸ì–´ë¡œ REST APIë¥¼ ë§Œë“¤ì–´ì•¼ê² ì£ .

ê°€ì¥ ê¸°ë³¸ì ì¸ Todo ì•±ì„ ë§Œë“¤ìƒê°ì…ë‹ˆë‹¤.

```sh
mkdir dockerfile-golang-rest-api

cd dockerfile-golang-rest-api

go mod init rest-api-todo

go get github.com/gin-gonic/gin

touch main.go
```

gin-gonicì„ ì´ìš©í•´ì„œ todo ì•±ì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

main.go íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ ë³¼ê¹Œìš”?

```go
package main

import (
	"fmt"
	"net/http"

	"github.com/gin-gonic/gin"
)

func displayRoot(context *gin.Context) {
	context.IndentedJSON(http.StatusOK, "Hello Todo App")
}

func main() {
	gin.SetMode(gin.ReleaseMode)

	router := gin.Default()

	if router != nil {
		fmt.Println("Started REST API..........")
	}

	router.GET("/", displayRoot)

	router.Run("0.0.0.0:80")
}
```

ìœ„ì™€ ê°™ì´ ì‘ì„±í•˜ê³  í„°ë¯¸ë„ì—ì„œ 'go run main.go'ì‹ìœ¼ë¡œ ì‘ë™í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ì—ì„œ "localhost" ì£¼ì†Œë¡œ ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜µë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEgIkJWCkNkY9_pE36R7dlXKzeOwpSU-ErwRfXg5Yyi_ugyqK8voMLKcxkMnAVcKoKDb6xS-CsFnKykgVwkfvHRnNzr_zD4NXQRF1qdIb5xUxiCLIn97L5idd9JS6De9xSQ445dYi0OTU59vTituJV5Ba4mL8JJ9G9DLEz4xw9yeZOP62Z2DxOfGdeoTltg)

ê·¸ë¦¬ê³  í„°ë¯¸ë„ ì°½ì€ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

```sh
go run main.go
Started REST API..........
[GIN] 2024/03/31 - 10:07:48 | 200 |      90.958Âµs |             ::1 | GET      "/"
```

ì„œë²„ê°€ ì™„ë²½íˆ ì‘ë™í•˜ë„¤ìš”.

ê·¸ëŸ¼ ë³¸ê²©ì ìœ¼ë¡œ Go ì–¸ì–´ë¥¼ ì´ìš©í•œ Todo ì•±ì„ í™•ì¥í•´ ë³´ê² ìŠµë‹ˆë‹¤.

```go
package main

import (
	"errors"
	"fmt"
	"net/http"

	"github.com/gin-gonic/gin"
)

type todo struct {
	ID        string `json:"id"`
	Item      string `json:"item"`
	Completed bool   `json:"completed"`
}

var todos = []todo{
	{ID: "1", Item: "Todo Test 1", Completed: false},
	{ID: "2", Item: "Todo Test 2", Completed: true},
	{ID: "3", Item: "Todo Test 3", Completed: false},
}

func displayRoot(context *gin.Context) {
	context.IndentedJSON(http.StatusOK, "Hello Todo App")
}

func getTodos(context *gin.Context) {
	context.IndentedJSON(http.StatusOK, todos)
}

func getTodo(context *gin.Context) {
	id := context.Param("id")
	todo, err := getTodoById(id)

	if err != nil {
		context.IndentedJSON(http.StatusNotFound, gin.H{"message": "Todo not Found!"})
	}
	context.IndentedJSON(http.StatusOK, todo)
}

func getTodoById(id string) (*todo, error) {
	for i, t := range todos {
		if t.ID == id {
			return &todos[i], nil
		}

	}
	return nil, errors.New("todos not found")
}

func addTodo(context *gin.Context) {
	var newTodo todo

	if err := context.BindJSON(&newTodo); err != nil {
		return
	}
	todos = append(todos, newTodo)
	context.IndentedJSON(http.StatusCreated, newTodo)
}

func toggleTodoStatus(context *gin.Context) {
	id := context.Param("id")
	todo, err := getTodoById(id)

	if err != nil {
		context.IndentedJSON(http.StatusNotFound, gin.H{"message": "Todo not found"})
	}
	todo.Completed = !todo.Completed
	context.IndentedJSON(http.StatusOK, todo)
}

func main() {
	gin.SetMode(gin.ReleaseMode)

	router := gin.Default()

	if router != nil {
		fmt.Println("Started REST API..........")
	}

	router.GET("/", displayRoot)
	router.GET("/todos", getTodos)
	router.GET("/todos/:id", getTodo)
	router.POST("/todos", addTodo)
	router.PATCH("/todos/:id", toggleTodoStatus)

	router.Run("0.0.0.0:80")
}
```

getTodos, getTodo, addTodo, toggleTodoStatus ë“± Todo ì•±ì„ ìœ„í•œ ìµœì†Œí•œì˜ ë¼ìš°í„°ë¥¼ ì™„ì„±ì‹œì¼°ë„¤ìš”.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiKVYPIINeonJLTf-ZdDwIVpDlGX0R-IXYDfK9uxBKB5NQ693xP1StxMUYrDk9LeNp7cOjURphW6z2JXXefIQZN3NMERhOwpexAAu61gamTB3_EIsPKCLcCytPRgOyxKaX0ciDwTJKOSjTc_NbYGFyo25I2l-o_jH3Gr_eTMv4SB0uVer3-igaMNF_kVmE)

ìœ„ì™€ ê°™ì´ ë¸Œë¼ìš°ì €ì—ì„œë„ ì‘ë™ì´ ì˜ ë˜ê³  ìˆìŠµë‹ˆë‹¤.

---

## Dockerfile ì´ë€?

ë„ì»¤ íŒŒì¼(Dockerfile)ì€ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´ë“¤ì„ ë‹´ê³  ìˆëŠ” í…ìŠ¤íŠ¸ ë¬¸ì„œì¸ë°ìš”.

ì´ ë¬¸ì„œëŠ” ì‚¬ìš©ìê°€ ì»¤ë§¨ë“œ ë¼ì¸ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥í•œ ëª¨ë“  ëª…ë ¹ì–´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ ë„ì»¤ëŠ” Dockerfileì„ ì½ì–´ì„œ ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ ë¹Œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  Dockerfileì€ ì´ë¯¸ì§€ë¥¼ êµ¬ì„±í•˜ëŠ”ë° í•„ìš”í•œ ëª¨ë“  ëª…ë ¹ì–´ë¥¼ ìˆœì„œëŒ€ë¡œ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.

ê°€ì¥ ì¤‘ìš”í•œ ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ë°ìš”.

| ëª…ë ¹ì–´ | ê¸°ëŠ¥ |
|-------|------|
| FROM | ì§€ì •ëœ ê¸°ë³¸ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. |
| WORKDIR | ì´ë¯¸ì§€ì˜ íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë‹¤ë¥¸ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. |
| COPY | íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë¥¼ ë³µì‚¬í•©ë‹ˆë‹¤. |
| ADD | ë¡œì»¬ ë˜ëŠ” ì›ê²© íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë¥¼ ì´ë¯¸ì§€ì— ì¶”ê°€í•©ë‹ˆë‹¤. |
| RUN | ì´ë¯¸ì§€ ë‚´ì—ì„œ OS ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. |
| ENV | í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. |
| EXPOSE | ì»¨í…Œì´ë„ˆê°€ íŠ¹ì • í¬íŠ¸ì—ì„œ ì‹œì‘ë˜ë„ë¡ ë„ì»¤ì— ì•Œë¦½ë‹ˆë‹¤. |
| USER | ì‚¬ìš©ìì™€ ê·¸ë£¹ IDë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì´ ì‚¬ìš©ìë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. |
| CMD | ì»¨í…Œì´ë„ˆ ì‹œì‘ í›„ ì‹¤í–‰ë  ëª…ë ¹ì–´ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. |
| ENTRYPOINT | ê¸°ë³¸ ì‹¤í–‰ íŒŒì¼ì„ ì§€ì •í•©ë‹ˆë‹¤. |
| SHELL | ê¸°ë³¸ ì‰˜ ì´ë¯¸ì§€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. |

ì´ì œ, ìœ„ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Dockerfileì„ ì‘ì„±í•˜ë©´, ì´ë¯¸ì§€ ë¹Œë“œ ê³¼ì •ì„ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```sh
touch Dockerfile
```

ìœ„ì™€ ê°™ì´ 'Dockerfile' ì´ë¼ëŠ” í™•ì¥ìê°€ ì—†ëŠ” íŒŒì¼ì„ ë§Œë“¤ì—ˆìœ¼ë©´, ì•„ë˜ì™€ ê°™ì´ Dockerfile ë‚´ë¶€ ëª…ë ¹ì–´ë¥¼ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

```sh
FROM alpine:3.18

SHELL ["/bin/sh", "-c"]

RUN adduser -D -u 1000 go_api_user

RUN apk update && \
     apk upgrade && \
     apk add --no-cache \
         curl

RUN curl -sSL https://dl.google.com/go/go1.21.6.linux-amd64.tar.gz | tar -C /usr/local -xz

ENV GOPATH=/go
ENV PATH=$PATH:/usr/local/go/bin:$GOPATH/bin
ENV API_URL=http://127.0.0.1/

WORKDIR /api

COPY . .

RUN go mod download

USER go_api_user

EXPOSE 80

CMD ["sh"]
```

ì´ Dockerfileì— ëŒ€í•´ ë” ìì„¸íˆ ì„¤ëª…ë“œë¦¬ìë©´,

1. **ê¸°ë³¸ ì´ë¯¸ì§€ ì„¤ì •**: Dockerfileì€ Alpine3.18 Linux ê¸°ë³¸ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ë©°, ê¸°ë³¸ ì‰˜ë¡œ "sh"ë¥¼ ì§€ì •í•˜ê³  "-c" í”Œë˜ê·¸ë¡œ ëª…ë ¹ ì¤„ ì¸ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

2. **ì‚¬ìš©ì ìƒì„±**: ROOT ì‚¬ìš©ìë¡œ ì‘ì—…í•˜ëŠ” ê²ƒì€ ê¶Œì¥ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚¬ìš©ìë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

3. **ì €ì¥ì†Œ ëª©ë¡ ì—…ë°ì´íŠ¸ ë° ì‹œìŠ¤í…œ ì—…ê·¸ë ˆì´ë“œ**: ë¡œì»¬ íŒŒì¼ì— ì €ì¥ì†Œ ëª©ë¡ì„ ì—…ë°ì´íŠ¸í•˜ê³  ì‹œìŠ¤í…œ(Alpine Linux)ì„ ì—…ê·¸ë ˆì´ë“œí•©ë‹ˆë‹¤. ë˜í•œ ì›¹ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê¸° ìœ„í•´ curlì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

4. **Go íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ ë° ì¶”ì¶œ**: ê³µì‹ ì €ì¥ì†Œì—ì„œ Go íŒ¨í‚¤ì§€(.tar) íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ì›í•˜ëŠ” í´ë”ì— ì¶”ì¶œí•©ë‹ˆë‹¤.

5. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**: í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

6. **ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •**: ìœ„ì—ì„œ ë§Œë“  'go_api_user' ì‚¬ìš©ìë¥¼ ìœ„í•œ ì‘ì—… ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

7. **REST API Go í”„ë¡œê·¸ë¨ í¬íŠ¸ ì„¤ì •**: ì»¨í…Œì´ë„ˆì˜ 80ë²ˆ í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ REST API Go í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë¥¼ localhostì˜ ì›í•˜ëŠ” í¬íŠ¸ì— ë§¤í•‘í•©ë‹ˆë‹¤. ğŸ˜

8. **ì´ë¯¸ì§€ ì‹¤í–‰**: ì»¨í…Œì´ë„ˆë¥¼ "sh" ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•¨ê»˜ ì‹œì‘í•©ë‹ˆë‹¤. ì´ëŠ” UNIXì˜ ê¸°ë³¸ ìµœì†Œ ì‰˜ì´ë©°, ì»¨í…Œì´ë„ˆê°€ 80ë²ˆ í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ë©ë‹ˆë‹¤.

---

## dockerignore íŒŒì¼

ë„ì»¤ íŒŒì¼(Dockerfile)ì„ ì™„ì„±í•œ í›„, Dockerfileì—ì„œ ìƒì„±ëœ ë„ì»¤ ì´ë¯¸ì§€ì— íŠ¹ì • íŒŒì¼ì„ í¬í•¨ì‹œí‚¤ì§€ ì•Šìœ¼ë ¤ë©´ .dockerignore íŒŒì¼ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

gitì„ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ .gitignore íŒŒì¼ì´ ìˆëŠ”ë° ì´ê²ƒê³¼ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤.

dockerignore íŒŒì¼ì˜ ë‚´ìš© ì˜ˆë¥¼ ë“¤ì–´ë³´ë©´, 

```plaintext
# .dockerignore íŒŒì¼ ë‚´ìš©
file_to_exclude.txt
directory_to_exclude/
```

ìœ„ ì˜ˆì‹œì—ì„œ `file_to_exclude.txt`ì™€ `directory_to_exclude/`ëŠ” ë„ì»¤ ì´ë¯¸ì§€ì— í¬í•¨ë˜ì§€ ì•Šë„ë¡ ì„¤ì •ëœ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.

ì´ë ‡ê²Œ .dockerignore íŒŒì¼ì„ ì‘ì„±í•˜ë©´ ì›í•˜ëŠ” íŒŒì¼ì„ ì´ë¯¸ì§€ì— í¬í•¨ì‹œí‚¤ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ë„ì»¤ ì´ë¯¸ì§€ ë§Œë“¤ê¸°

ì´ì œ ë„ì»¤ë¡œ ìš°ë¦¬ê°€ ì‘ì„±í–ˆë˜ Go ì–¸ì–´ì˜ todo ì•±ê³¼ 'Dockerfile'ì´ ìˆëŠ” í˜„ì¬ í´ë”ì—ì„œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

'docker build' ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ì„œ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.

```sh
docker build -t rest_api_golang_todos .
```

ì‹¤í–‰ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¤ëŠ”ë°ìš”.

```sh
î‚° docker build -t rest_api_golang_todos .
[+] Building 71.1s (13/13) FINISHED                                            docker:desktop-linux
 => [internal] load build definition from Dockerfile                                           0.0s
 => => transferring dockerfile: 468B                                                           0.0s
 => [internal] load metadata for docker.io/library/alpine:3.18                                 2.7s
 => [auth] library/alpine:pull token for registry-1.docker.io                                  0.0s
 => [internal] load .dockerignore                                                              0.0s
 => => transferring context: 2B                                                                0.0s
 => [1/7] FROM docker.io/library/alpine:3.18@sha256:11e21d7b981a59554b3f822c49f6e9f57b6068bb7  1.1s
 => => resolve docker.io/library/alpine:3.18@sha256:11e21d7b981a59554b3f822c49f6e9f57b6068bb7  0.0s
 => => sha256:24b42af5b7bdb9ccf1252e508ee0a4fd85eb3286a4596c422739ae6beb3038f4 528B / 528B     0.0s
 => => sha256:33abbf0321492ff7379e60c252c05c4e7ed4dccf46fcca6c558067c25e76dc8 1.49kB / 1.49kB  0.0s
 => => sha256:c6b39de5b33961661dc939b997cc1d30cda01e38005a6c6625fd9c7e748bab4 3.33MB / 3.33MB  1.0s
 => => sha256:11e21d7b981a59554b3f822c49f6e9f57b6068bb74f49c4cd5cc4c663c7e516 1.64kB / 1.64kB  0.0s
 => => extracting sha256:c6b39de5b33961661dc939b997cc1d30cda01e38005a6c6625fd9c7e748bab44      0.1s
 => [internal] load build context                                                              0.0s
 => => transferring context: 19.57kB                                                           0.0s
 => [2/7] RUN adduser -D -u 1000 go_api_user                                                   0.2s
 => [3/7] RUN apk update &&      apk upgrade &&      apk add --no-cache          curl          3.8s
 => [4/7] RUN curl -sSL https://dl.google.com/go/go1.21.6.linux-amd64.tar.gz | tar -C /usr/l  16.4s
 => [5/7] WORKDIR /api                                                                         0.0s
 => [6/7] COPY . .                                                                             0.0s
 => [7/7] RUN go mod download                                                                 45.5s
 => exporting to image                                                                         1.2s
 => => exporting layers                                                                        1.2s
 => => writing image sha256:5e471b36e45db1c15281b3078d9e9fb60ee0b5c70d62a03403328083a42b5de5   0.0s
 => => naming to docker.io/library/rest_api_golang_todos                                       0.0s

What's Next?
  View a summary of image vulnerabilities and recommendations â†’ docker scout quickview
```

ì´ì œ ë„ì»¤ ì´ë¯¸ì§€ê°€ ìƒì„±ëìœ¼ë‹ˆ ì´ë¯¸ì§€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

'docker images' ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜µë‹ˆë‹¤.

```sh
î‚° docker images
REPOSITORY              TAG       IMAGE ID       CREATED              SIZE
rest_api_golang_todos   latest    5e471b36e45d   About a minute ago   717MB
```

717MBì˜ 'rest_api_golang_todos'ë¼ëŠ” ì´ë¯¸ì§€ê°€ ë§Œë“¤ì–´ì¡Œë„¤ìš”.

---

## ë„ì»¤ ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°

ì´ì œ ìœ„ì—ì„œ ë§Œë“  ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ì ê¹ ì—¬ê¸°ì„œ í•„ìš”í•œê²Œ localhostì™€ì˜ í¬íŠ¸ ë§¤í•‘ì¸ë°ìš”.

ìš°ë¦¬ê°€ ë§Œë“  todoì•±ì€ 80 í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ°ë° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë¡œì»¬ì—ì„œëŠ” ë‹¤ë¥¸ í¬íŠ¸ë¡œ ë§¤í•‘í•˜ê² ìŠµë‹ˆë‹¤.

ì´ ë•Œ ì“°ì´ëŠ” í”Œë˜ê·¸ ì˜µì…˜ì´ ë°”ë¡œ '-p' ì˜µì…˜ì¸ë°ìš”.

'-p' ì˜µì…˜ì€ '-p host_port:container_port' ì´ëŸ°ì„ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```sh
docker run -it -p 9090:80 rest_api_golang_todos
```

ìœ„ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ ë˜ëŠ”ë°ìš”.

ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ ë„ì»¤ê°€ ì‹¤í–‰ë˜ë©´ì„œ ìš°ë¦¬ê°€ ì„¤ì •í•œ ì•ŒíŒŒì¸ ë¦¬ëˆ…ìŠ¤ì™€ í•´ë‹¹ 'api' í´ë”ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.

```sh
î‚° docker run -it -p 9090:80 rest_api_golang_todos
/api $ ls
Dockerfile            go.sum                main.go
go.mod                README.md
```

ìœ„ì™€ ê°™ì´ 'ls' ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¤ë‹ˆê¹Œ ìš°ë¦¬ê°€ ë¡œì»¬ì—ì„œ ê°œë°œí–ˆë˜ ëª¨ë“  íŒŒì¼ì´ ë‚˜ì˜µë‹ˆë‹¤.

ì™œëƒí•˜ë©´ Dockerfileì˜ ì•„ë˜ ëª…ë ¹ì–´ ë•Œë¬¸ì…ë‹ˆë‹¤.

```sh
WORKDIR /api

COPY . .
```

ì´ì œ ì•ŒíŒŒì¸ ë¦¬ëˆ…ìŠ¤ì—ì„œ 'go run main.go' ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ ë³¼ê¹Œìš”?

```sh
/api $ go run main.go
Started REST API..........
```

ìœ„ì™€ ê°™ì´ ì¡°ê¸ˆ ì‹œê°„ì´ ê±¸ë¦¬ê³  ë‚œ í›„ REST APIê°€ ì‘ë™ë©ë‹ˆë‹¤.

ì´ì œ ë¸Œë¼ìš°ì €ì—ì„œ 'localhost:9090'í¬íŠ¸ë¡œ ì´ë™í•´ì„œ ë³´ë©´ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì˜ ì‘ë™í•˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEgi92RKINihHZFBv1jllVkAX0NHKabqyAmgxKn612Ca9Me4zgcG-abhSUK3GzZWQjFMgXO8B1uTpXgZ1YfCJY-wpqbBANBqd_N8Pcd20qSEUJlP9wquKXFbNPDAbQhbc5hM76rG1yH1yc6A5zF2POjspzUcd_HKKF_vTTvTYOZpiBzujoeWTPQWdALiPdM)

![](https://blogger.googleusercontent.com/img/a/AVvXsEgzcrRTg9JoNHK0yC3mm0QoEZ3gUcXczdEku2EoKGZxu6OWZ0Tmz_jWVbViVw097YNAJWktKswhOVdBCsz5A4lElYMPl6EAuz8cLXojUTV2IB3V-P99OT9mDtndgTHdlyYI2P-nD68RTk3YJiK-ezPjr8YFdapUF9KqKBEVIOW2NUBZM0RhTrRDvMdhf4o)

![](https://blogger.googleusercontent.com/img/a/AVvXsEgzOn4kwQ3OGGos8soHWaK2H4R4Yq-4u3sGEliLruRE4Mq2e-RRmgvvQXlxOovV0rsfcUy-JxfFDdsfp3zBW-w0oHBMMNZrmVydGNFSnTVbucG4dh_OXZ_Y2wV2Gg9ftiB1a-SsJNq926aWpYtg7FaCsHLCaNpI967dbJ5p1Pa9-l1NaLDyszQtjILVgYA)

ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ì˜ ì‘ë™ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  í„°ë¯¸ë„ ì°½ì—ì„œë„ ì•„ë˜ì™€ ê°™ì´ gin-gonicì˜ ë¡œê·¸ê°€ ì˜ ë³´ì´ê³ ìš”.

```sh
/api $ go run main.go
Started REST API..........
[GIN] 2024/03/31 - 01:36:44 | 200 |    3.585792ms |    192.168.65.1 | GET      "/"
[GIN] 2024/03/31 - 01:36:44 | 404 |       1.834Âµs |    192.168.65.1 | GET      "/favicon.ico"
[GIN] 2024/03/31 - 01:37:25 | 200 |    7.273833ms |    192.168.65.1 | GET      "/todos"
[GIN] 2024/03/31 - 01:37:33 | 200 |     831.625Âµs |    192.168.65.1 | GET      "/todos/1"
```

---

## Dockerfileì— ì‹¤í–‰ ì½”ë“œê¹Œì§€ ë„£ê¸°

ìš°ë¦¬ê°€ ìœ„ì—ì„œëŠ” docer run ì˜µì…˜ì—ì„œ '-it' ì˜µì…˜ì„ ì£¼ì—ˆëŠ”ë°ìš”.

ì´ê±¸ ë¹¼ê³  ì‹¤í–‰í•˜ë©´ ê·¸ëƒ¥ ëë‚˜ë²„ë¦½ë‹ˆë‹¤.

```sh
docker run -p 9090:80 rest_api_golang_todos
```

ê·¸ë˜ì„œ Dockerfileì— ìš°ë¦¬ê°€ ë§Œë“  ì•±ì„ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì¶”ê°€í•˜ë©´ ë˜ëŠ”ë°ìš”.

ë§ˆì§€ë§‰ì— ì•„ë˜ì™€ ê°™ì´ ENTRYPOINTë¥¼ ì§€ì •í•˜ë©´ ë©ë‹ˆë‹¤.

```sh
FROM alpine:3.18 AS builder

SHELL ["/bin/sh", "-c"]

RUN adduser -D -u 1000 go_api_user

RUN apk update && \
     apk upgrade && \
     apk add --no-cache \
         curl

RUN curl -sSL https://dl.google.com/go/go1.21.6.linux-amd64.tar.gz | tar -C /usr/local -xz

ENV GOPATH=/go
ENV PATH=$PATH:/usr/local/go/bin:$GOPATH/bin
ENV API_URL=http://127.0.0.1/

WORKDIR /api

COPY . .

RUN go mod download

RUN go build -o main .

USER go_api_user

EXPOSE 80

FROM scratch

COPY --from=builder /api/main .

ENTRYPOINT ["/main"]
```

ìœ„ ë„ì»¤íŒŒì¼ì—ì„œëŠ” main.go íŒŒì¼ì„ ì»´íŒŒì¼ê¹Œì§€ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì»´íŒŒì¼ëœ main ì´ë¼ëŠ” ì‹¤í–‰íŒŒì¼ì„ builderë¼ëŠ” ì•ŒíŒŒì¸ ë¦¬ëˆ…ìŠ¤ì—ì„œ ì¹´í”¼í•´ ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ENTRYPOINTë¥¼ ì§€ì •í•˜ë©´ í•´ë‹¹ íŒŒì¼ì´ ì‹¤í–‰í•˜ê²Œ ë˜ëŠ”ë°ìš”.

ì´ì œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ë°ìš”.

```sh
docker build -t rest_api_golang_todos . 
```

ë„ì»¤ê°€ ë‹¤ì‹œ ë‹¤ ë§Œë“¤ì–´ì§€ë©´ 'docker run'ì„ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•´ ë´…ì‹œë‹¤.

```sh
docker run -p 9090:80 rest_api_golang_todos
Started REST API..........
[GIN] 2024/03/31 - 01:59:00 | 200 |    7.434959ms |    192.168.65.1 | GET      "/todos/1"
```

ì´ì œ í´ë¼ìš°ë“œì— ë°”ë¡œ ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ì½”ë“œê°€ ì™„ì„±ë˜ì—ˆë„¤ìš”.

---

## DockerHubì— ì´ë¯¸ì§€ ì˜¬ë ¤ë³´ê¸°

ë„ì»¤ ì´ë¯¸ì§€ì— tagë¥¼ ë¶€ì—¬í•˜ë©´ ë²„ì „ ê´€ë¦¬ê°€ ì•„ì£¼ ì‰¬ìš´ë°ìš”.

```sh
docker image tag b2ea rest_api_golang_todos:v1

docker images
REPOSITORY              TAG       IMAGE ID       CREATED          SIZE
rest_api_golang_todos   latest    b2ea50f60cec   6 minutes ago    11.5MB
rest_api_golang_todos   v1        b2ea50f60cec   6 minutes ago    11.5MB
```

ìœ„ì™€ ê°™ì´ TAGì— v1ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ rest_api_golang_todos ì´ë¯¸ì§€ê°€ ìƒê²¼ìŠµë‹ˆë‹¤.

ê·¸ëŸ°ë° rest_api_golang_todosë¼ëŠ” ì´ë¦„ì€ DockerHUBì— ëˆ„êµ°ê°€ ë¨¼ì € ì˜¬ë ¤ë†¨ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— TAG ì´ë¦„ì— ë³¸ì¸ ì•„ì´ë””ë¥¼ ë„£ëŠ”ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.

```sh
docker image tag b2ea cpro95/rest_api_golang_todos:v1

docker images
REPOSITORY                     TAG       IMAGE ID       CREATED          SIZE
cpro95/rest_api_golang_todos   v1        b2ea50f60cec   8 minutes ago    11.5MB
rest_api_golang_todos          latest    b2ea50f60cec   8 minutes ago    11.5MB
rest_api_golang_todos          v1        b2ea50f60cec   8 minutes ago    11.5MB
```

ì´ì œ ë„ì»¤ì— ë¡œê·¸ì¸í•˜ê² ìŠµë‹ˆë‹¤.

```sh
docker login

Authenticating with existing credentials...
Login Succeeded
```

ì €ëŠ” docker desktopì—ì„œ ë¡œê·¸ì¸ í•´ ë†“ì€ ìƒíƒœë¼ì„œ ìœ„ì™€ ê°™ì´ ë°”ë¡œ ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ì œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ push í•´ë³´ê² ìŠµë‹ˆë‹¤.

```sh
docker push cpro95/rest_api_golang_todos:v1

The push refers to repository [docker.io/cpro95/rest_api_golang_todos]
d928abf30a5d: Pushed 
v1: digest: sha256:0947ac45f239698619d52f04ac2aa6cd64e899a7bd8bfed3796a2c1a688e0e97 size: 527
```

ìœ„ì™€ ê°™ì´ ë‚˜ì˜¤ë„¤ìš”.

ë„ì»¤ push ê°€ ì„±ê³µí–ˆìŠµë‹ˆë‹¤.

DockerHUB í™ˆí˜ì´ì§€ì—ì„œ ë³¼ê¹Œìš”?

![](https://blogger.googleusercontent.com/img/a/AVvXsEjwnBLv3xU6NKA6NOpsAe6TLWbUyYeznyd9skDB-SxMfrZdhnwpTDSRcBsvhqsn8egJ4nTBMBT1gDO3s0zPzC8SS1hmE91ouDpOJeNm2BJNii8BIpZfKwK54fV0rAK-bXaI2Vj_HW7UMh8LbqB2SdHLZzbXHPs5qxjCc1u2E2uN24-cym8z2OHax7ypmTg)

ìœ„ì™€ ê°™ì´ ì˜ ì˜¬ë¼ê°€ ìˆë„¤ìš”.

ê·¸ë¦¬ê³  í™ˆí˜ì´ì§€ì—ì„œ Tagsë¥¼ í´ë¦­í•˜ë©´ v1ì´ë¼ëŠ” ë²„ì „ì´ ë‚˜ì˜¤ë©´ì„œ PULL í•  ìˆ˜ ìˆëŠ” ì½”ë“œë„ ì œê³µí•´ ì¤ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEh5JP-nzEkCa40oP4mflz7EJgADZZaU5rQQEYqLkKSfdDdDXfIP3a4s_JLmxDAscuDAeuXIkpKNqu4Xz4FT3bRHQEDiGqb-d7msrin5ZB_Mixh-BMqjlcgXVtr10DmuBdShKcj6kA0BgXWH729Z57e5VR0hMT1JrWidVbPj03GvVkNZQvBf9oWyYTF_Fig)

ì´ì œ dockerhubì— ìˆëŠ” ì´ë¯¸ì§€ë¥¼ pullí•´ì„œ ì‚¬ìš©í•´ ë³¼ê¹Œìš”?

```sh
docker rmi b2ea --force 
```

ìœ„ì™€ ê°™ì´ í˜„ì¬ ë¡œì»¬ì— ìˆëŠ” ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ê°•ì œë¡œ ì§€ì› ìŠµë‹ˆë‹¤.

```sh
docker images
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE
```
ìœ„ì™€ ê°™ì´ í˜„ì¬ ë„ì»¤ ì´ë¯¸ì§€ê°€ ì—†ëŠ” ìƒíƒœì…ë‹ˆë‹¤

ì´ì œ ë„ì»¤ pull í•´ë³´ê² ìŠµë‹ˆë‹¤.

```sh
docker pull cpro95/rest_api_golang_todos:v1

docker images
REPOSITORY                     TAG       IMAGE ID       CREATED          SIZE
cpro95/rest_api_golang_todos   v1        b2ea50f60cec   24 minutes ago   11.5MB
```

ë„ì»¤ í’€ ëª…ë ¹ì–´ê°€ ì˜ ì‘ë™í•˜ë„¤ìš”.

ì—¬ê¸°ì„œ ë„ì»¤ ëŸ° ëª…ë ¹ì–´ëŠ” ì•„ë˜ì™€ ê°™ì´ í•´ì•¼ í•©ë‹ˆë‹¤.

```sh
docker run -p 9090:80 cpro95/rest_api_golang_todos:v1
Started REST API..........
```

ìš°ë¦¬ê°€ íƒœê·¸ì´ë¦„ì„ ë‹¤ë¥´ê²Œ í•´ì„œ ê¼­ íƒœê·¸ ì´ë¦„ì— ìœ ì˜í•´ì„œ run ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

---

