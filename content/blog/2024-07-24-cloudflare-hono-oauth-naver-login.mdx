---
slug: 2024-07-24-cloudflare-hono-oauth-naver-login
title: Cloudflare, Honoì—ì„œ OAuthë¥¼ ì´ìš©í•´ì„œ ë„¤ì´ë²„ ì•„ì´ë””ë¡œ Login êµ¬í˜„í•´ ë³´ê¸°
date: 2024-07-24T12:22:56.945Z
description: Cloudflare, Honoì—ì„œ OAuthë¥¼ ì´ìš©í•´ì„œ ë„¤ì´ë²„ ì•„ì´ë””ë¡œ Login êµ¬í˜„í•´ ë³´ê¸°
meta:
  keywords:
    - OAuth
    - Cloudflare
    - Hono
    - Naver Login
    - Session
published: true
---

# Cloudflare, Honoì—ì„œ OAuthë¥¼ ì´ìš©í•´ì„œ ë„¤ì´ë²„ ì•„ì´ë””ë¡œ Login êµ¬í˜„í•´ ë³´ê¸°

ì•ˆë…•í•˜ì„¸ìš”?

ì§€ë‚œ ì‹œê°„ì— Cloudflareì™€ Hono í”„ë ˆì„ì›Œí¬, ê·¸ë¦¬ê³  êµ¬ê¸€ OAuth ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ì„œ SSR ë°©ì‹ì˜ ë¡œê·¸ì¸ êµ¬í˜„ì„ ì•Œì•„ë´¤ëŠ”ë°ìš”.

ì§€ë‚œ ì‹œê°„ ë§í¬ì…ë‹ˆë‹¤.

[Cloudflareì—ì„œ Honoì™€ Google OAuthë¥¼ ì´ìš©í•´ì„œ Login êµ¬í˜„í•´ ë³´ê¸°](https://mycodings.fly.dev/blog/2024-07-21-cloudflare-hono-google-login)

ì˜¤ëŠ˜ì€ êµ­ë‚´ ì œ1ì˜ í¬í„¸ì¸ ë„¤ì´ë²„ ì•„ì´ë””ë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ë„¤ì´ë²„ ì•„ì´ë””ë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ë ¤ë©´ ë„¤ì´ë²„ ë””ë²¨ë¡œí¼ì— ê°€ì…í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë“±ë¡í•´ì•¼ í•©ë‹ˆë‹¤.

ë¹ ë¥¸ ë§í¬ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

[ë„¤ì´ë²„ ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡](https://developers.naver.com/apps/#/register?api=nvlogin)

ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¤ëŠ”ë°ìš”.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiUMDtIoM0kvRqH_l0NP7XcfVf4OF5SKNkxtFFE9FrXPrKnkb3dg9HZz7Ikt0UR1G4Y5CbsCPQmiYogVnR_2BAGfWsqLe8dzirChRx08BP0xKUt8hRuc_rWa43hz_lJvHzTONb-F0u8MNAmx7MxR4Ntovw4RAotbSRB-u-G_y7euxiMSnf4bFbshkbWweY)

ì—¬ê¸°ì— ì ë‹¹íˆ ì´ë¦„ì„ ì‘ì„±í•˜ê³ , ì¤‘ìš”í•œ ë¶€ë¶„ì€ ì•„ë˜ì…ë‹ˆë‹¤.

ë°”ë¡œ ë„¤ì´ë²„ ë¡œê·¸ì¸ì„ ì´ìš©í–ˆì„ ë•Œ ë„¤ì´ë²„ì—ì„œ ì—¬ëŸ¬ë¶„ì˜ ì•±ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë¶€ë¶„ì„ ì„ íƒí•˜ëŠ” ê²ë‹ˆë‹¤.

ìµœëŒ€í•œ ì ê²Œ ê³ ë¥´ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEifaEok_Bn1A_aVP-I6GvMttzNvpSHcRUK6z8QQx7_O_O1KT4AWustgZV7VeabS3wsC7inxN7QClSwDNaZdaivWi3OXVmqczNfnXqQeIIB0c0S0OWkpMeUN2s0HMbK4A-OFvp3RHFX5MZYTXtR9ppLcLTNMavIykIZs8voNL7opX9oTtzgP3Hy9jgIstOo)

ì ë‹¹íˆ ë³„ëª…ê³¼ í”„ë¡œí•„ ì‚¬ì§„ ì •ë„ë©´ ë©ë‹ˆë‹¤.

ì´ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë™í•˜ëŠ” í™˜ê²½ì„ ì„¤ì •í•´ ì¤˜ì•¼ í•˜ëŠ”ë°ìš”.

ì•ˆë“œë¡œì´ë“œ, IOS, ì›¹ ë“± ì—¬ëŸ¬ê°€ì§€ê°€ ìˆëŠ”ë°, ì—¬ê¸°ì„œëŠ” PC ì›¹ì„ ê³ ë¥´ê² ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì„œë¹„ìŠ¤ URLê³¼ ì½œë°±ì£¼ì†Œë¥¼ ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•´ ë†“ìœ¼ë©´ ë©ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiKtOYsjrLbmTzyVhm4Fu7XuoEwYX6KBvSTkk-BOoDZrAbhMjseNav9N5m41z1ZB2U-cJqHmSQr2iKE95K8YhZ9w3RacgRgxM0mqpiIlNQe5o0pHNBoSk3LsPTEg2md1FldE3vtR9wu2Qmoe3weSGSJZZ4aq7NQnG50hhz0JnlIZhBjKRtok5Vljf2ee8g)

ë‹¤ ë§Œë“¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ”ë°ìš”.

Client ID, Client SecretëŠ” ìš°ë¦¬ê°€ ì½”ë“œì— ê¼­ ë„£ì–´ì•¼ í•˜ëŠ”ê±°ë¼ ë³µì‚¬í•´ ë†“ìœ¼ë©´ ë©ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEhAqWq4QZtY0bNHmNERzg4BpIdfaFR3wGP1KDim51hQbp5PS6u3nS9OzqxOKSXuotM0C3n_d0uveUnEczaSEo3mPCBRVT3lAVSbzHU_RGUe7Ch7qEOGP3UBxKh9AwMu3CromzWlXtKIZcLFE69RmU5iJXDbIvngOSDDwn42SzT21sOMtiWqeN1P-QUMqBg)

ì´ì œ ë„¤ì´ë²„ ë””ë²¨ë¡œí¼ì—ì„œ í•  ì¼ì€ ëë‚¬ìŠµë‹ˆë‹¤.

ë³¸ê²©ì ì¸ ì½”ë”©ì— ë“¤ì–´ê°€ ë³´ê² ìŠµë‹ˆë‹¤.

---

## í…œí”Œë¦¿ ë§Œë“¤ê¸°

Hono ì•±ì„ ë§Œë“œëŠ” ê±°ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ëŠ” ë¹ ë¥¸ Bunì„ ì´ìš©í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```sh
bunx create-hono bun-oauth-naver-login-test
create-hono version 0.10.0
âœ” Using target directory â€¦ bun-oauth-naver-login-test
? Which template do you want to use? cloudflare-pages
âœ” Cloning the template
? Do you want to install project dependencies? yes
? Which package manager do you want to use? bun
âœ” Installing project dependencies
ğŸ‰ Copied project files
Get started with: cd bun-oauth-naver-login-test
```

ì´ì œ, src í´ë”ì˜ index.tsx íŒŒì¼ì„ ìˆ˜ì •í•´ì„œ ì½”ë“œë¥¼ ì´ì–´ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ì‚¬ì‹¤ êµ¬ê¸€ ë¡œê·¸ì¸ê³¼ ì•„ì£¼ ë˜‘ê°™ì€ ë¡œì§ì¸ë°ìš”.

ë¨¼ì €, "login" ë¼ìš°íŒ… ë¶€ë¶„ì…ë‹ˆë‹¤.

```js
app.get("/login", (c) => {
  const AUTH_ENDPOINT = "https://nid.naver.com/oauth2.0/authorize";
  const params = {
    client_id: CLIENT_ID,
    response_type: "code",
    redirect_uri: REDIRECT_URI,
    state: STATE,
  };
  return c.redirect(`${AUTH_ENDPOINT}?${new URLSearchParams(params)}`);
});
```

ì—­ì‹œë‚˜, ë‹¨ìˆœí•˜ê²Œ ë„¤ì´ë²„ì˜ authorize APIë¡œ redirectí•©ë‹ˆë‹¤.

ë‹¹ì—°íˆ params ê°ì²´ì— ë„¤ì´ë²„ ë””ë²¨ë¡œí¼ì—ì„œ ë°›ì€ CLIENT_ID ê·¸ë¦¬ê³  REDIRECT_URI, ë˜ ë„¤ì´ë²„ì—ì„œë§Œ ìš”êµ¬í•˜ëŠ” STATE ê°’ë„ ë„£ì–´ì„œ ì „ë‹¬í•´ ì£¼ê³  ìˆìŠµë‹ˆë‹¤.

state ê°’ì€ ë‚œìˆ˜ì˜ ë¬¸ìì—´ì´ë©´ ë©ë‹ˆë‹¤.

ì´ ì•„ë¬´ëŸ° ë¬¸ìì—´ì„ ê°€ì§€ê³  authorize APIì—ì„œë„ ì‚¬ìš©í•˜ê³ , ë‚˜ì¤‘ì— ì•¡ì„¸ìŠ¤ í† í° ì–»ì„ ë•Œë„ ê°™ì€ ë¬¸ìì—´ì˜ stateë¥¼ ì‚¬ìš©í•  ê²ë‹ˆë‹¤.

ê·¸ë˜ì„œ ì¤‘ê°„ì— API íƒˆì·¨ë¥¼ ë°©ì§€í•˜ëŠ” ëª©ì ìœ¼ë¡œ state ê°’ì´ ì“°ì´ëŠ”ê²ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ state ê°’ì„ ìƒì„±í•´ ì¤˜ì•¼í•˜ëŠ”ë°ìš”.

ë‹¨ìˆœí•˜ê²Œ "imstate" ë¼ê³  ì§€ì •í•´ ì¤˜ë„ ì‘ë™í•˜ëŠ”ë°ëŠ” ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë­”ê°€ ìˆì–´ ë³´ì´ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ í•˜ì‹œëŠ”ê²Œ ì¢‹ì„ ë“¯ í•˜ë„¤ìš”.

```js
function generateState(length: number) {
  const charset =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  let state = "";
  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * charset.length);
    state += charset[randomIndex];
  }
  return encodeURIComponent(state);
}

// "í´ë¼ì´ì–¸íŠ¸ ë“±ë¡"ì—ì„œ ì·¨ë“í•œ ê°’ì„ ë³€ìˆ˜ì— ì„¤ì •í•©ë‹ˆë‹¤
const CLIENT_ID = "D~~~~~~~~~~~`S";
const CLIENT_SECRET = "l~~~~~~h";
const REDIRECT_URI = "http://localhost:5173/callback";
const STATE = generateState(16);
```

ì´ì œ, login ë¼ìš°íŒ… ë¶€ë¶„ì€ ëë‚¬ìŠµë‹ˆë‹¤.

ì§€ê¸ˆê¹Œì§€ ë‚˜ì˜¨ ì½”ë“œ ì „ë¶€ë¥¼ ìˆœì„œì™€ ê´€ê³„ì—†ì´ ê·¸ëƒ¥ index.tsx íŒŒì¼ ì•ˆì—ë§Œ ë„£ì–´ë„ Hono í”„ë ˆì„ì›Œí¬ëŠ” ì‘ë™í•˜ë‹ˆê¹Œ ê±±ì •í•˜ì§€ ë§ˆì‹­ì‹œìš”.

ì°¸ê³ ë¡œ ì•„ë˜ ê·¸ë¦¼ì€ ë„¤ì´ë²„ì˜ authorize API ì„¤ëª… ìº¡ì³ë³¸ì…ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEjW0rheeimpDz9MnfSZ3A3HdEUye7jFj93Z8D-V50zOAvVzNzgN83OGu6UAvIymbKm8adWDpOooorDKI2DCa6lxzL00BBFib81RCyVGhZeTsBrhM_-ZfNEbeBfxQh2c5cyhfFBnQ5RMmK9eA8oPCldllFi9SyhsbmwbdkpYKl2CpJWNGwU_zYQil_DReLs)

---

## ì½œë°± URL ì‘ì„±í•˜ê¸°

ì§€ê¸ˆê¹Œì§€ "login" ë¼ìš°íŒ…ì—ì„œ í•œê±°ëŠ” ë„¤ì´ë²„ authorize APIì— ë‹¨ìˆœí•˜ê²Œ ê°’ë§Œ ë„£ì–´ GET ë©”ì„œë“œë¡œ HTTP Request í•œê²ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ë„¤ì´ë²„ authorize APIëŠ” OAuth 2.0ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì— ì½œë°± URLë¡œ code ê°’ê³¼ state ê°’ì„ ê·¸ëŒ€ë¡œ ëŒë ¤ì¤ë‹ˆë‹¤.

ë‹¨, ë„¤ì´ë²„ ë¡œê·¸ì¸ì„ í†µê³¼í–ˆì„ ë•Œë§Œì´ì£ .

ì—¬ê¸°ì„œ ì‘ë™í•˜ëŠ”ê²Œ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë„¤ì´ë²„ ë¡œê·¸ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©ê³¼ ê´€ë ¨í•œ ì•ˆë‚´ ë¬¸êµ¬ê°€ ëœ¹ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEjeq5kvqPYai5NSijtTHYlAxIetF5IpU7hVpG2FaTtSS_YIfWyGZi5yXwvmN9AszOb2XwKBM728Pn1OaDkq9e5EylHSKlABnlZb6T0m43TrlyOt-zk3xwZ-FLoBOVKsrufTmUlCEMTHaz2KqWUV1NlTE7V9vAj6LEWRkF9-qhpxi4vHN3sQToQUUw6SVnw)

ìœ„ ë¬¸êµ¬ì—ì„œ ë™ì˜í•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë„¤ì´ë²„ ì•„ì´ë””ë¡œ ë¡œê·¸ì¸í•˜ë©´, ì¦‰ ë„¤ì´ë²„ ì•„ì´ë”” ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ ì•„ê¹Œ ì„¤ëª…í–ˆë“¯ì´ ë„¤ì´ë²„ ë””ë²¨ë¡œí¼ì—ì„œ ì„¤ì •í•œ ì½œë°± URLë¡œ redirect í•´ì¤ë‹ˆë‹¤.

ì´ê²Œ ë°”ë¡œ OAuth ì‘ë™ë°©ì‹ì…ë‹ˆë‹¤.

ëŒ€ì‹  ì½œë°± URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í•´ì¤„ë•Œ code ê°’ê³¼ stateê°’ë„ ê°™ì´ ì¤ë‹ˆë‹¤.

ìš°ë¦¬ëŠ” ì½œë°± URLì—ì„œ code ê°’ê³¼ state ê°’ì„ ì´ìš©í•´ì„œ ì•¡ì„¸ì„œ í† í°ì„ ì–»ê²Œ ë˜ëŠ”ê±°ì£ .

ì‹¤ì œ ì‹¤í–‰í•´ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì—ëŸ¬ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

ì™œëƒí•˜ë©´ ì½œë°± URL ë¼ìš°íŒ…ì„ ì‘ì„±í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiiqCZmy1vhWStBqNXN9m4nmxyO8BmZwqgJYd6mccgoQFOQy6UwvfBKOYlQHSoOkWkVfI6iSVYpJeyxKLbPmtdspAJ2qdGbJv9pgq6RJMah6Dw4D6FTub7SUbbgBLJjxB1YNImQcFF_cuQqjEjLOBoOA3_gCDtunkZSW2tFqAW4h_rC748LjTdwf9bYv0s)

ì°¸ê³ ë¼ ì•„ë˜ ê·¸ë¦¼ì€ ë„¤ì´ë²„ì—ì„œ ì œê³µí•´ì£¼ëŠ” ì½œë°± URL ê´€ë ¨ API ìƒì„¸ ì„¤ëª…ì˜ ìº¡ì³ë³¸ì…ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEijrK9MiHeHbCYWIAjhxFUCtBwxjiBZv_mOfuTHfdFy8LhGbfRzxeChN5XTzeJq9MLzOi7XZY9EGtVVVxiVwMMfGeUArbTZH0G-3M9qKm76R9HXi58mpM8G0QiW5pOAQQTnL0iFokuOxjmTcmOxf5K9zpsWDvXl9TSXNxwEWgIn3UBaB6eUPc1l6Ha1Hmo)

ê·¸ë¦¬ê³  ì•„ë˜ëŠ” ì•¡ì„¸ìŠ¤ í† í° ì ‘ê·¼ ê´€ë ¨ API ì„¤ëª…ì…ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEhjXVIhOuzIcH_uxZ0PrD-IfRn1aFlsUFnSPXwQzi4F7QAHxCpigF4sWrxE69ihV0GfxmCy6suUT63D0TN3rXwRYWcso7FJ86WuvikMvitKwseaIphdsK3Tl4CoeU_cBKfCP1Lmk8-xbPGZcBwXWYUaWX8xDXNde2pMOP5jLHKVRRL1-pa0EK_G49yvr2k)

![](https://blogger.googleusercontent.com/img/a/AVvXsEhT7eCUgrs9gVYMfrC5uFhUG5bcy6PndmeA1YJx20rryqk_StaGDkHEzj0rM0G8dGt9O5SVaVgSDVWh0iL70IS8TgVGZcMnkB4dlQjhrj0dgJYO1on7UfyG8MK4ruLn1rtsLbVL5h9if0gLD1XdLYXkAxUXWLhY6CyNiv_8n6rH3N9n1sNRz6rWbYwXaXU)

ì•„ë˜ ê·¸ë¦¼ì€ ì•¡ì„¸ìŠ¤ í† í°ì„ ë°›ëŠ” APIì˜ ë¦¬í„´ íƒ€ì…ì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiMamWZQqRx03zf1R66Us40S1sfGuPF0ufIz1TiPCBSSrl8QtHuHzaRZryyL375enrcsA4aXD-UtC6uTCU4V30XA_vDrD5ednQo3kLolIKcyQ28Qwxaz7rcX-cJKF3a2PrN34N8Y3hfZye1N3pDe3VY1GeT1fSDpq_KJZdX8dSrYPE_eQCxYwAyg8PbCUc)

ì´ì œ ë³¸ê²©ì ì¸ ì½œë°± ë¼ìš°íŒ… ì½”ë“œë¥¼ êµ¬í˜„í•´ ë´…ì‹œë‹¤.

```js
interface TokenResponse {
  access_token: string;
  expires_in: number;
  token_type: string;
  scope: string;
  refresh_token?: string;
}

interface UserInfo {
  id: string;
  nickname: string;
  profile_image: string;
}

app.get("/callback", async (c) => {
  const TOKEN_ENDPOINT = "https://nid.naver.com/oauth2.0/token";
  const code = c.req.query("code") || "";
  const state = c.req.query("state") || "";

  if (!code) {
    return c.text("Authorization code not found", 400);
  }

  const params = {
    client_id: CLIENT_ID,
    client_secret: CLIENT_SECRET,
    grant_type: "authorization_code",
    code: code,
    redirect_uri: REDIRECT_URI,
    state: state,
  };

  try {
    const response: any = await fetch(TOKEN_ENDPOINT, {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
      },
      body: new URLSearchParams(params),
    });

    if (!response.ok) {
      const errorResponse: any = await response.json();
      return c.json(errorResponse, response.status);
    }

    const data: TokenResponse = await response.json();
    const access_token = data.access_token;
    console.log(`ACCESS_TOKEN is : ${access_token}`);

    const userInfoResponse: any = await fetch(
      "https://openapi.naver.com/v1/nid/me",
      {
        headers: {
          Authorization: `Bearer ${access_token}`,
        },
      }
    );
    if (!userInfoResponse.ok) {
      const errorResponse = await userInfoResponse.json();
      return c.json(errorResponse, userInfoResponse.status);
    }

    const userInfoResponseJSON: any = await userInfoResponse.json();
    const userInfo: UserInfo = userInfoResponseJSON.response;
    console.log(userInfo); // ì‚¬ìš©ì ì •ë³´ ì¶œë ¥

    // ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •
    const sessionCookie = Buffer.from(JSON.stringify(userInfo)).toString(
      "base64"
    );

    setCookie(c, "session", sessionCookie, {
      path: "/",
      secure: process.env.NODE_ENV === "production",
      httpOnly: true,
      maxAge: 60 * 60 * 24, // 1 day
    });

    return c.redirect("/");
  } catch (error) {
    return c.text("An error occurred during token exchange", 500);
  }
});
```

ìœ„ ì½”ë“œ ë¶€ë¶„ì€ ì§€ë‚œ ì‹œê°„ì— ë°°ì› ë˜ êµ¬ê¸€ ì•„ì´ë”” ë¡œê·¸ì¸ê³¼ 99% ìœ ì‚¬í•˜ê¸° ë•Œë¬¸ì— ì „ì²´ ì½”ë“œë§Œ ë„£ì—ˆìŠµë‹ˆë‹¤.

ìš°ë¦¬ê°€ ë°›ì€ code ê°’ê³¼ state ê°’ì„ c.req.query ë¶€ë¶„ì—ì„œ ì–»ì–´ì„œ ê·¸ëŒ€ë¡œ ë‹¤ì‹œ ì•¡ì„¸ìŠ¤ í† í°ì„ ì–»ëŠ” APIì˜ params ê°’ìœ¼ë¡œ ë„£ê³  ìˆìŠµë‹ˆë‹¤.

ì•¡ì„¸ìŠ¤ í† í°ì„ ì–»ìœ¼ë©´ ì´ì œ ì‚¬ìš©ì ì •ë³´ë¥¼ ìš”ì²­í•˜ëŠ” APIì— ì ‘ê·¼í•´ì„œ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ë©´ ëì…ë‹ˆë‹¤.

ë„¤ì´ë²„ ìœ ì € ì •ë³´ ê°€ì ¸ì˜¤ëŠ” APIì˜ ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEjbdPoIoSC2KX3A2xU2gMWNlT9ZWwWJXBYge0b5--eJUS6LYrkb5xp1UZHRVcZGl5UwiJTyB8umHbxdgaaaa3uuW87TcTOw9TlnWs9Kro7rkQK-V81HGx9ddy5yGtpfgQ5Cn1PlQqCwIDqvdYXy9ClTyFasVum-4c0ZFJuAnULGOyecDPQfcdXJjh4EvUI)

ì°¸ê³ ë¡œ userInfo ë¶€ë¶„ì˜ ì½˜ì†”ì°½ì€ ì•„ë˜ì™€ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEjY363x3Wfr8niEIs78o86DKOlAyVBoEzlhVF4quB1sdayyzVzELy1lNuPK6e3saG-dtUDY3veAz_QJDwrALipGtdDVtSq422ZjInJE1hsC7OvrG4zwa4jaFkgLiIS5nd4nw-N_tp_ICeXsoddYJjRjpF8oFPzARhjV5vg8HJFia6OwA-75Tz0u18NVUJU)

![](https://blogger.googleusercontent.com/img/a/AVvXsEjX8ae49g-ZQ8qJYV9WHvnNuELmu2DGL3VWT79qsZQQo_uyj_KmQiUqwFPdWOHw3gUr7brraZnWfiUhRxy8WvAF2-Irs2ePGgu680XHBNOHVIKDvfUVtRtAnKvD54fCE-MWflFPNq9_Kj9deEtcR_kZFzTIlr5lvujNm6_Pyfbs_WgzveaTRnJLev05MG8)

ìœ„ ê·¸ë¦¼ì„ ë³´ì‹œë©´ ë„¤ì´ë²„ APIê°€ ì œê³µí•´ì£¼ëŠ” JSON ê²°ê³¼ì¹˜ì—ì„œ response ê°’ë§Œ í•„ìš”í•˜ë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„ ê·¸ë¦¼ì„ ë³´ì‹œë©´ ì œ ì•„ì´ë””, ë‹‰ë„¤ì„, í”„ë¡œíŒŒì¼ ì´ë¯¸ì§€ê°€ ë‚˜ì™€ìˆë„¤ìš”.

ì‚¬ì‹¤ ìœ ì € ë¡œê·¸ì¸ì€ ì´ ì •ë„ ì •ë³´ë§Œ ìˆì–´ë„ ì¶©ë¶„í•©ë‹ˆë‹¤.

ìœ„ ì½”ë“œì˜ ë§ˆì§€ë§‰ì— ì¿ í‚¤ ì„¤ì •í•œ ê±¸ ë³¼ ìˆ˜ ìˆëŠ”ë°ìš”.

ìœ ì € ì •ë³´ ìì²´ë¥¼ BASE64ë¡œ ì¸ì½”ë”©í•´ì„œ ì¿ í‚¤ì— ë„£ì—ˆìŠµë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ "/" ë¼ìš°íŒ…ì—ì„œ ì¿ í‚¤ë¥¼ ì´ìš©í•´ì„œ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ëì…ë‹ˆë‹¤.

---

## í™ˆ ë¼ìš°íŒ… ì‘ì„±í•˜ê¸°

```js
app.get("/", (c) => {
  const session = getCookie(c, "session");
  if (session) {
    const userInfo: UserInfo = JSON.parse(
      Buffer.from(session, "base64").toString("utf-8"),
    );
    // return c.json({ message: "Logged in", user: userInfo });
    return c.render(
      <>
        <h1>welcome : {userInfo.id}</h1>
        <img height="80" src={userInfo.profile_image} />
        <form method="post" action="/logout">
          <button type="submit">logout</button>
        </form>
      </>,
    );
  }

  return c.text("Welcome to the home page. Please log in.");
});

app.post("/logout", async (c) => {
  deleteCookie(c, "session");
  return c.redirect("/");
});

```

ìœ„ì™€ ê°™ì´ ì‘ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEh34ZfbpdvwdOJ2S8yF7L7aIxMnWRTrggDt1qXAmXtZpos2375h7At5lxR04Ob-v0WC370ix05WLezDlE4FpptrQlRZFypWTEf98txy63RCt7pWX5H-_YPB0sv8-I_otiBgFFBDiIYEJUtSDuS4qFxlmQc9BqLg-Pp26M-s6jX9U_7TESheFQ4folSw0ww)

ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ê³¼ ë¡œì§ë„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ í…ŒìŠ¤íŠ¸ í•´ë³´ì‹­ì‹œìš”.

ì•„ì£¼ ì˜ ì‘ë™í•  ê²ë‹ˆë‹¤.

ì§€ê¸ˆê¹Œì§€ ë„¤ì´ë²„ ì•„ì´ë””ë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸ì„ Honoë¥¼ ì´ìš©í•´ì„œ Cloudflareì—ì„œ êµ¬í˜„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.

ê·¸ëŸ¼.

