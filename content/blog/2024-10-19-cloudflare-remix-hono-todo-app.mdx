---
slug: 2024-10-19-cloudflare-remix-hono-todo-app
title: Fullstack ê°•ì¢Œ - Hono RPC + Remix + Cloudflare + D1 DB ì¡°í•©ìœ¼ë¡œ Todo ì•± ë§Œë“¤ê¸°
date: 2024-10-19T03:00:08.015Z
description: Hono RPC ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ API Endpoint êµ¬ì¶•í•˜ì—¬ Remix Frameworkìœ¼ë¡œ Todo ì•± ë§Œë“¤ê¸°
meta:
  keywords:
    - remix
    - hono
    - rpc
    - cloudflare
    - api endpoint
    - todo app
published: true
---

# Fullstack ê°•ì¢Œ - Hono RPC + Remix + Cloudflare + D1 DB ì¡°í•©ìœ¼ë¡œ Todo ì•± ë§Œë“¤ê¸°

ì•ˆë…•í•˜ì„¸ìš”?


ì§€ë‚œ ì‹œê°„ì— ì´ì–´ Cloudflareì—ì„œ Remix Frameworkê³¼ Honoì˜ RPC ê¸°ëŠ¥ì„ í™œìš©í•œ API Endpoint êµ¬ì¶•í•˜ê¸° 2ë²ˆì§¸ í¸ì¸ Todo ì•± ë§Œë“¤ê¸°ë¥¼ ì§„í–‰í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

1í¸ì—ì„œëŠ” Hono RPCë¥¼ ì´ìš©í•œ API Endpointë¥¼ KVë¡œ êµ¬ì¶•í–ˆëŠ”ë°ìš”.

APIë¥¼ Honoë¡œ ì‘ì„±í•˜ëŠ” ë°©ë²•ê³¼ Remixì—ì„œ Honoë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•, ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ Cloudflare networkì— ë°°í¬ê¹Œì§€ ëëƒˆëŠ”ë°ìš”.

ì˜¤ëŠ˜ì€ ë³¸ê²©ì ì¸ í…ŒìŠ¤íŠ¸ ì•±ìœ¼ë¡œ Todo ì•±ì„ D1 DBë¥¼ ì´ìš©í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ì§€ë‚œ ì‹œê°„ì—ëŠ” KVì˜ ì‚¬ìš©ë°©ë²•ì„ ë°°ì› ê¸° ë•Œë¬¸ì— ì˜¤ëŠ˜ì€ D1 DBë¥¼ ë°°ì›Œë³¸ë‹¤ëŠ” ê°œë…ìœ¼ë¡œ ê°•ì˜ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

ì•„ë˜ëŠ” ì§€ë‚œ ì‹œê°„ ê°•ì¢Œ ë§í¬ì…ë‹ˆë‹¤.

[Cloudflareì—ì„œ Remix Frameworkê³¼ Honoì˜ RPC ê¸°ëŠ¥ì„ í™œìš©í•œ API Endpoint êµ¬ì¶•í•˜ê¸°](https://mycodings.fly.dev/blog/2024-10-14-cloudflare-remix-framework-hono-rpc-api-endpoint)

---

## D1 DB ì„¤ì •

ë¨¼ì €, D1 DBì˜ ì„¤ì •ë¶€í„° ì‹œì‘í•´ì•¼í•˜ëŠ”ë°ìš”.

í„°ë¯¸ë„ ìƒì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•˜ì‹œë©´ wranglerê°€ ì•„ì£¼ ì‰½ê²Œ DBë¥¼ êµ¬ì¶•í•´ ì¤ë‹ˆë‹¤.

```sh
$ npx wrangler d1 create remix-hono-todo-test

 â›…ï¸ wrangler 3.57.1 (update available 3.80.5)
-------------------------------------------------------
âœ… Successfully created DB 'remix-hono-todo-test' in region APAC
Created your new D1 database.

[[d1_databases]]
binding = "DB" # i.e. available in your Worker on env.DB
database_name = "remix-hono-todo-test"
database_id = "b8asfdfa-9sadfe37-4fasdfd71-casdfsddb614" # ì°¸ê³ ë¡œ, ê°•ì˜ë¥¼ ìœ„í•œ fake idì…ë‹ˆë‹¤.
```

ìœ„ì™€ ê°™ì´ í„°ë¯¸ë„ìƒì— D1 DBì˜ ì„¤ì • ì„¸íŒ…ê°’ê¹Œì§€ ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì£¼ëŠ”ë°ìš”.

wrangler.toml íŒŒì¼ì˜ ì•„ë˜ë¶€ë¶„ì„ ìœ„ì—ì„œ ì–»ì€ ì„¸íŒ…ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ë©´ ëì…ë‹ˆë‹¤.

```sh
# [[d1_databases]]
# binding = "MY_DB"
# database_name = "my-database"
# database_id = "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
```

ì´ì œ D1 DBë¥¼ ìƒì„±ê¹Œì§€ í–ˆëŠ”ë°ìš”.

ì´ì œëŠ” ì‹¤ì œ DBì˜ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

ë³´í†µ ì—¬ê¸°ì„œ Drizzle ORM ê°™ì€ ORMì„ ì‚¬ìš©í•˜ëŠ”ë°ìš”.

ì œ ì˜ˆì „ ê°•ì¢Œ ë³´ì‹œë©´ Drizzle ORM ì‚¬ìš©ë²•ì´ ë‚˜ì˜µë‹ˆë‹¤.

ê·¸ëŸ°ë° ì˜¤ëŠ˜ì€ Drizzle ORM ì—†ì´ ì§„í–‰í•´ ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

ë¨¼ì €, ë§Œë“¤ë ¤ê³  í•˜ëŠ” í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆ íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

ì¼ë‹¨ db í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ë°‘ì— 'schema.sql' íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ë§Œë“­ì‹œë‹¤.

```sh
DROP TABLE IF EXISTS Todos;
CREATE TABLE IF NOT EXISTS Todos (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  completed INTEGER NOT NULL DEFAULT 0
);

INSERT INTO Todos (title) VALUES ("test");
```

ìœ„ì—ì„œ ë³´ì‹œëŠ” ê±´ ë°”ë¡œ SQlite3ì˜ SQL ë¬¸(statement)ì¸ë°ìš”.

ì˜ì–´ ê·¸ëŒ€ë¡œ í•´ì„í•˜ì…”ë„ ì‰½ê²Œ ë¬´ìŠ¨ ëœ»ì¸ì§€ ì•Œ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.

ì´ ê°•ì¢ŒëŠ” SQLite3 ê°•ì¢Œê°€ ì•„ë‹ˆë¼ì„œ ìƒì„¸í•œ ì„¤ëª…ì€ ê±´ë„ˆ ë›°ê² ìŠµë‹ˆë‹¤.

ìœ„ sql íŒŒì¼ì€ Todosë¼ëŠ” í…Œì´ë¸”ì„ ë§Œë“œëŠ”ë°, idëŠ” integer ê°’ (ì •ìˆ˜ê°’)ì´ê³  autoincrement ì„±ê²©ì„ ê°–ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  titleì€ í…ìŠ¤íŠ¸ ê°’ì´ê³ , ì¤‘ìš”í•œ completedëŠ” ì•„ë¬´ë¦¬ ë´ë„ boolean ê°’ì´ ë“¤ì–´ê°€ì•¼ í•˜ëŠ”ë°, ìœ„ì—ì„œëŠ” integer ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ë°ìš”.

SQlite3ëŠ” boolean íƒ€ì…ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ integer íƒ€ì…ìœ¼ë¡œ ì„¤ì •í•˜ê³  0 ì´ë©´ false, 1 ì´ë©´ trueë¡œ ì·¨ê¸‰í•˜ëŠ”ê²Œ ì¼ë°˜ì ì¸ ì½”ë”© ë£°ì…ë‹ˆë‹¤.

ê·¸ë¦¬ê³  ë””í´íŠ¸(default) ê°’ìœ¼ë¡œ 0ìœ¼ë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì— ì•„ë¬´ê²ƒë„ ì•ˆí•˜ë©´ ì•Œì•„ì„œ 0ìœ¼ë¡œ ì„¸íŒ…ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ ë”ë¯¸ ë°ì´í„° í•œê°œë¥¼ INSERT ë¬¸ìœ¼ë¡œ ì‚½ì…í–ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ schema.sql íŒŒì¼ì„ ì•„ê¹Œ ìš°ë¦¬ê°€ ë§Œë“  'DB'ë¼ëŠ” ë°”ì¸ë”© ì´ë¦„ì¸ ì‹¤ì œ DBì— ì ìš©í•´ì•¼ í•˜ëŠ”ë°ìš”.

ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì€ ë‘ êµ°ë°ì— ì ìš©í•´ì•¼ í•œë‹¤ëŠ” ê²ë‹ˆë‹¤.

í•œ êµ°ë°ëŠ” ì‹¤ì œ Cloudflare Networkìƒì˜ D1 DBì— ì ìš©í•˜ëŠ” ê±°ê³ , ë‘ ë²ˆì§¸ëŠ” ë¡œì»¬ ì¦‰, ìš°ë¦¬ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ê°œë°œ ì„œë²„ë¥¼ ëŒë¦¬ëŠ” ì—¬ëŸ¬ë¶„ì˜ ì‹¤ì œ ì»´í“¨í„°ì— ì ìš©í•´ì•¼í•˜ëŠ” ê²ë‹ˆë‹¤.

ë¡œì»¬ ê°œë°œ ì„œë²„ì— ì„¤ì¹˜í•˜ë ¤ë©´ '--local' ì˜µì…˜ì„ ì£¼ë©´ ë˜ê³ , ì‹¤ì œ Cloudflare Networkì— ì ìš©í•˜ë ¤ë©´ '--remote' ì˜µì…˜ì„ ì£¼ë©´ ë©ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì‹¤ì œë¡œ ì ìš©í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ì•„ë˜ì™€ ê°™ì´ í„°ë¯¸ë„ì—ì„œ ëª…ë ¹ë¬¸ì„ ì…ë ¥í•˜ê³  ì‹¤í–‰í•´ ë³´ì‹œì£ .

```sh
$ npx wrangler d1 execute remix-hono-todo-test --local --file=./db/schema.sql

 â›…ï¸ wrangler 3.57.1 (update available 3.80.5)
-------------------------------------------------------
ğŸŒ€ Executing on local database remix-hono-todo-test
(xxxx-x-x-x-x-xxx-x-x-x-x) from .wrangler/state/v3/d1:
ğŸŒ€ To execute on your remote database, add a --remote flag to your wrangler command.
```

ìœ„ì™€ ê°™ì´ d1 ë‹¤ìŒì— execute ëª…ë ¹ì–´ë¥¼ ì£¼ë©´ ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  '--local' ì˜µì…˜ê³¼ schema.sql íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ëŠ” '--file' ì˜µì…˜ì„ ì£¼ì—ˆìŠµë‹ˆë‹¤.

ìœ„ì™€ ê°™ì´ ë‚˜ì˜¤ë©´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ëœê²ë‹ˆë‹¤.

ê·¸ë¦¬ê³  ë‘ ë²ˆì§¸ ì‹¤ì œ Cloudflare Network ìƒì— í…Œì´ë¸”ì„ ìƒì„±í•˜ë ¤ë©´ '--local' ì˜µì…˜ì„ '--remote'ë¼ëŠ” ì˜µì…˜ìœ¼ë¡œ ë°”ê¿” ì£¼ë©´ ë©ë‹ˆë‹¤.

```sh
$ npx wrangler d1 execute remix-hono-todo-test --remote --file=./db/schema.sql     

 â›…ï¸ wrangler 3.80.5
-------------------

âœ” âš ï¸ This process may take some time, during which your D1 database will be unavailable to serve queries.
  Ok to proceed? â€¦ yes
ğŸŒ€ Executing on remote database remix-hono-todo-test
(xxxxx-xxxxx-x-x-x-x-x-x
):
ğŸŒ€ To execute on your local development database, remove the --remote flag from your wrangler command.
Note: if the execution fails to complete, your DB will return to its original state and you can safely retry.
â”œ ğŸŒ€ Uploading xxxxx-xxxxx-x-x-x-x-x-x cf2be6e449aa524e.sql 
â”‚ ğŸŒ€ Uploading complete.
â”‚ 
ğŸŒ€ Starting import...
ğŸŒ€ Processed 3 queries.
ğŸš£ Executed 3 queries in 0.00 seconds (3 rows read, 6 rows written)
   Database is currently at bookmark
   00000002-00005-00e2d-7412dc6fa898327fcf8a378bf.
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Total queries executed â”‚ Rows read â”‚ Rows written â”‚ Database size (MB) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3                      â”‚ 3         â”‚ 6            â”‚ 0.02               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

"Ok to proceed? ë¼ê³  ë‚˜ì˜¤ëŠ”ë° ì—”í„°í‚¤ë¥¼ ëˆ„ë¥´ë©´ ì§„í–‰ë©ë‹ˆë‹¤.

ê°„í˜¹ê°€ë‹¤ê°€ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë‚˜ì˜¬ë•Œê°€ ìˆëŠ”ë°ìš”.

wrangler ë²„ì „ ê´€ë ¨ ë¬¸êµ¬ê°€ ë‚˜ì˜¬ ë•Œê°€ ìˆìŠµë‹ˆë‹¤.

```sh
âœ˜ [ERROR] Cannot read properties of undefined (reading 'forEach')
```

ì´ëŸ´ ë•ŒëŠ” wranglerë¥¼ í•´ë‹¹ ìµœì‹ ë²„ì „ì„ ì˜¬ë¦¬ë©´ í•´ê²°ë©ë‹ˆë‹¤.

ì´ì œ ì‹¤ì œ Cloudflare ëŒ€ì‹œë³´ë“œì— ê°€ì„œ í™•ì¸í•´ ë³¼ê¹Œìš”?

![](https://blogger.googleusercontent.com/img/a/AVvXsEik_5D7zxnb5saWp91vYX4DEtfX8Z1WGgCCYg7q5wRl_8_SMlfVa-LeN4DTqV8a-YCALi_GNEHHV6HakE0LNca_f3KMXxPPmHFSuE0o6U-UMQbrIHtNzMVCgjeLQxyM90Yak5Iwm5a_pSY967j-1Qfs5Gn_NOG_vrdKUdiSw_10CC9LLCEO6ZiYbbxJ0qk)

ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ì˜ ì ìš©ë˜ì—ˆë„¤ìš”.

---

## DB ë°”ì¸ë”© ê°’ Envì— ì ìš©í•˜ê¸°

ì´ì œ ìƒˆë¡œìš´ Cloudflare ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ë ¤ê³  ì„¸íŒ…í–ˆê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ "typegen" ëª…ë ¹ì–´ë¡œ Env ì¸í„°í˜ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

í„°ë¯¸ë„ ìƒì— ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•©ì‹œë‹¤.

```sh
$ npm run typegen

> typegen
> wrangler types


 â›…ï¸ wrangler 3.80.5
-------------------

Generating project types...

interface Env {
        kv: KVNamespace;
        SECRET: "secret is hono-remix-adapter";
        DB: D1Database;
}
```

ìœ„ì™€ ê°™ì´ wranglerê°€ Env ì¸í„°í˜ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸ í–ˆë„¤ìš”.

í•´ë‹¹ ë‚´ìš©ì€ 'worker-configuration.d.ts' íŒŒì¼ì— ì˜ ì ìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì´ì œ Hono RPCì—ì„œ D1 DBë¥¼ ì´ìš©í•  ì¤€ë¹„ê°€ ë‹¤ ëë‚¬ìŠµë‹ˆë‹¤.

ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ Honoë¥¼ ì´ìš©í•´ì„œ Todo ì•±ì„ ìœ„í•œ API Endpointë¥¼ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.

---

## Honoë¡œ API route êµ¬ì¶•í•˜ê¸°

Honoì˜ ì„œë²„ íŒŒì¼ì´ server í´ë”ì˜ index.ts íŒŒì¼ì¸ë°ìš”.

ì´ íŒŒì¼ì•ˆì— ëª¨ë“  ë¼ìš°íŒ…ì˜ API ì½”ë“œë¥¼ ì‘¤ì…” ë„£ëŠ”ë‹¤ëŠ” ê±°ëŠ” ì¡°ê¸ˆ ë¹„íš¨ìœ¨ì ì¸ë°ìš”.

ë‹¤í–‰íˆ HonoëŠ” ëª¨ë“ˆëŸ¬ ë°©ì‹ì˜ ì½”ë“œ ìª¼ê°œê¸°(Splitting)ì„ ì§€ì›í•´ ì¤ë‹ˆë‹¤.

server í´ë”ì— api í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ë°‘ì— ë˜ ë‹¤ì‹œ todos í´ë”ë¥¼ ë§Œë“¤ê³  todos í´ë” ë°‘ì— ì¼ë‹¨ 'index.ts' íŒŒì´ì„ ë§Œë“­ì‹œë‹¤.

ì´ íŒŒì¼ì´ ìš°ë¦¬ê°€ ë§Œë“œë ¤ê³  í•˜ëŠ” 'api/todos'ê°€ ì—”ë“œí¬ì¸íŠ¸ì¸ API ë¼ìš°íŒ…ì˜ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” íŒŒì¼ì´ ë˜ëŠ”ê²ë‹ˆë‹¤.

ì¼ë‹¨ ì´ íŒŒì¼ì˜ êµ¬ì„±ì„ ëŒ€ì²´ì ìœ¼ë¡œ ì‚´í´ë´…ì‹œë‹¤.

```ts
// '/server/api/todo/index.ts'

import { Hono } from "hono";

import { getTodos } from "./model";

// RPCë¥¼ ìœ„í•´ì„œëŠ” new Hono<>().get í˜•ì‹ìœ¼ë¡œ ë¶™í˜€ì„œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
const api_todos = new Hono<{ Bindings: Env }>()
  .get("/todos", async (c) => {
    const todos = await getTodos(c.env.DB);
    return c.json(todos);
});

export default api_todos;
```

ìœ„ì™€ ê°™ì´ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

RPCë¥¼ ìœ„í•´ì„œëŠ” Hono ê°ì²´ë¥¼ ë§Œë“¤ê³  ê¼­ ë©”ì„œë“œ ì²´ì´ë‹ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.

Hono ê³µì‹ë¬¸ì„œì—ì„œë„ ì–˜ê¸°í•´ ì£¼ì§€ ì•Šì•„ ì´ê±° ë•Œë¬¸ì— 3ì‹œê°„ ì‚½ì§ˆí–ˆëŠ”ë°ìš”.

ì¼ë‹¨ ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì €ëŠ” ì‹¤ì œ DB ê´€ë ¨ëœ ì½”ë“œëŠ” model ì´ë€ íŒŒì¼ì— ë³„ë„ë¡œ ë”°ë¡œ ì‘ì„±í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

'/server/api/todo/index.ts' íŒŒì¼ì€ ìˆœì „íˆ Honoì˜ ë¼ìš°íŒ…ë§Œ ì¤‘ì ì ìœ¼ë¡œ ì§‘ì¤‘í•˜ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤.

ì°¸ê³ ë¡œ 'c.env.DB'ë¼ê³  í•˜ë©´ ìš°ë¦¬ê°€ ë§Œë“  Cloudflare D1 DBë¥¼ ì§€ì¹­í•˜ê²Œ ë©ë‹ˆë‹¤.

ì™œ ì´ë¦„ì´ DBëƒë©´ ì•„ê¹Œ ìš°ë¦¬ê°€ ì•„ë˜ì™€ ê°™ì´ ì§€ì •í•œ ê·¸ ì´ë¦„ì´ 'DB'ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë³„ì¹­ì„ ë§Œë“¤ì–´ë„ ë©ë‹ˆë‹¤.

```sh
[[d1_databases]]
binding = "DB" # i.e. available in your Worker on env.DB
database_name = "remix-hono-todo-test"
database_id = "b8asfdfa-9sadfe37-4fasdfd71-casdfsddb614"
```

ê·¸ëŸ¬ë©´ ê°™ì€ í´ë”ì— model.ts íŒŒì¼ì„ ë§Œë“¤ê³  getTodos í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

```ts
import { z } from "zod";

// Todo ìŠ¤í‚¤ë§ˆ
export const TodoSchema = z.object({
  id: z.number().optional(),
  title: z.string().min(1).max(100),
  completed: z.number().default(0),
});

export interface Todo {
  id: number;
  title: string;
  completed: number;
}

export const getTodos = async (DB: D1Database): Promise<Todo[]> => {
  try {
    // SQL ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ D1ì—ì„œ ëª¨ë“  Todo í•­ëª©ì„ ê°€ì ¸ì˜´
    const result = await DB.prepare("SELECT * FROM Todos").all<Todo>();

    // ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ë°˜í™˜
    return result.results || [];
  } catch (error) {
    console.error("Failed to fetch todos from D1 DB", error);
    return [];
  }
};
```

ìœ„ ì½”ë“œë¥¼ ë³´ì‹œë©´ ë‚˜ì¤‘ì„ ìœ„í•´ TodoSchemaë¥¼ ë¯¸ë¦¬ ì„¸íŒ…í•´ ë†¨ìŠµë‹ˆë‹¤.

POST ë©”ì„œë“œì¼ ë•Œ ì“¸ ì˜ˆì •ì…ë‹ˆë‹¤.

ê·¸ë¦¬ê³  Promise ë¦¬í„´ íƒ€ì…ìœ¼ë¡œ ì“¸ Todo íƒ€ì…ì„ interfaceë¥¼ ì´ìš©í•´ì„œ ìƒˆë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ëŒ€ë§ì˜ getTodos í•¨ìˆ˜ì¸ë°ìš”.

Cloudflare D1 DB íŠœí† ë¦¬ì–¼ì— ê°€ì‹œë©´ DB.prepare í•¨ìˆ˜ì™€ all, run, first ë©”ì„œë“œë¥¼ ì“°ëŠ” ë°©ë²•ì´ ë‹¤ ë‚˜ì™”ìœ¼ë‹ˆ ê¼­ ì½ì–´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.

ìœ„ ì½”ë“œëŠ” Todos í…Œì´ë¸”ì—ì„œ ëª¨ë“  ê±¸ (all ë©”ì„œë“œ ì‚¬ìš©) ê°€ì ¸ì˜¤ë¼ëŠ” ëª…ë ¹ì¸ë°ìš”.

D1 DBê°€ all() í•¨ìˆ˜ë¡œ ì‹¤í–‰ë˜ë©´ ë¦¬í„´í•˜ëŠ” result ê°ì²´ì˜ íƒ€ì…ì„ ë¯¸ë¦¬ ê³µë¶€í•  í•„ìš”ê°€ ìˆëŠ”ë°ìš”.

ì•„ë˜ì™€ ê°™ì€ íƒ€ì…ìœ¼ë¡œ ë¦¬í„´ë©ë‹ˆë‹¤.

```ts
// result type of method all()
    {
      success: true,
      meta: {
        served_by: 'miniflare.db',
        duration: 0,
        changes: 0,
        last_row_id: 0,
        changed_db: false,
        size_after: 16384,
        rows_read: 1,
        rows_written: 0
      },
      results: [ { id: 9, title: '1111', completed: 0 } ]
    }
```

ì‹¤ì œ Sqlite3ì˜ ë¦¬í„´íƒ€ì…ì€ ìœ„ì™€ ê°™ì§€ ì•ŠìŠµë‹ˆë‹¤.

ìœ„ì™€ ê°™ì€ ë¦¬í„´ íƒ€ì…ì€ Cloudflareê°€ modifyí•œ ê²ë‹ˆë‹¤.

ì¼ë‹¨ success ê°’ìœ¼ë¡œ SQL ì¿¼ë¦¬ ì‹¤í–‰ì—¬ë¶€ë¥¼ ì‰½ê²Œ ì•Œì•„ ë³¼ ìˆ˜ ìˆê³ , results ê°’ìœ¼ë¡œ ë¦¬í„´ê°’ë§Œ ì‰½ê²Œ ì•Œ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ì œ getTodos í•¨ìˆ˜ì˜ ì—­í• ì´ ì´í•´ ë˜ì‹œì£ ?

ì´ì œ getTodos í•¨ìˆ˜ì™€ Honoì˜ API Endpoint êµ¬ì„±ì´ 90% ëë‚¬ìŠµë‹ˆë‹¤.

ë§ˆì§€ë§‰ 10%ì˜ ì„¤ì •ì€ ë°”ë¡œ server í´ë”ì˜ index.ts íŒŒì¼ì— ìš°ë¦¬ê°€ ë§Œë“  API Endpoint ë¼ìš°íŒ…ì„ ì‚½ì…ì‹œí‚¤ê³  RPCë¥¼ ìœ„í•œ AppTypeì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

```ts
// '/server/index.ts'

import { Hono } from "hono";
import { cors } from "hono/cors";
import api_todos from "./api/todos";

const app = new Hono<{ Bindings: Env }>();

app.use("*", cors());

// KVë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ì˜ˆì „ ì½”ë“œ
app.get("/hono-test", async (c) => {
  const { kv } = c.env;

  await kv.put("hono-remix-adapter", "hono can access cloudflare kv");
  const value = await kv.get("hono-remix-adapter");
  console.log(value);

  return c.text(
    `Hono kv is ok, value is ${value} ,\n My_var is ${c.env.SECRET}`
  );
});

const route = app.route("/api", api_todos);

export default app;

// Hono RPCë¥¼ ìœ„í•œ AppType export ì‹œí‚¤ê¸°
export type AppType = typeof route;
```

ìœ„ ì½”ë“œë¥¼ ì˜ ë³´ì‹œë©´ ì¼ë‹¨ Hono ê°ì²´ë¥¼ appì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

ì´ app ì´ë¼ëŠ” ì´ë¦„ì˜ Honoê°ì²´ê°€ ë©”ì¸ ë¼ìš°íŒ…ì´ë˜ê³ , ê·¸ë¦¬ê³  ì•„ê¹Œ ìš°ë¦¬ê°€ ë§Œë“¤ì—ˆë˜ api_todos ë¼ìš°íŒ…ì´ ì„œë¸Œ ë¼ìš°íŒ…ì´ ë˜ëŠ”ê±°ì£ .

ê·¸ë¦¬ê³  export type AppType ë°©ì‹ìœ¼ë¡œ RPCë¥¼ ìœ„í•œ AppTypeì„ export í–ˆìŠµë‹ˆë‹¤.

ì°¸ê³ ë¡œ, ë©”ì¸ ë¼ìš°íŒ…ì´ ë˜ëŠ” appê°ì²´ì— get ë©”ì„œë“œë¡œ 'hono-test' ë¼ëŠ” ë¼ìš°íŒ…ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

KVë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•´ ì˜ˆì „ì— ì‘ì„±í•œ ì½”ë“œì…ë‹ˆë‹¤.

ì‚¬ì‹¤ ìœ„ ì½”ë“œëŠ” ì—†ì–´ë„ ë˜ëŠ”ë° ìˆœì „íˆ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë‚¨ê²¨ë†“ì€ ê±°ë‹ˆ ë‚˜ì¤‘ì— ë¶ˆí•„ìš”í•˜ì‹œë©´ ì§€ìš°ì‹œë©´ ë©ë‹ˆë‹¤.

ì´ì œ ì„¤ì •ì´ ëë‚¬ìŠµë‹ˆë‹¤.

---

## Remixì—ì„œ RPCë¥¼ ì´ìš©í•´ì„œ getTodos í•¨ìˆ˜ ì‹¤í–‰í•˜ê¸°

ì´ì œ Client side ìª½ ì½”ë“œì…ë‹ˆë‹¤.

ì—„ë°€íˆëŠ” Remix Framework ìª½ ì½”ë“œë¥¼ ë§Œë“¤ì–´ì•¼ ê² ì£ .

ë¨¼ì €, RPCë¥¼ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ìœ í‹¸ë¦¬í‹° íŒŒì¼ì„ ë¨¼ì € ë§Œë“­ì‹œë‹¤.

app í´ë” ë°‘ì— utils í´ë”ë¥¼ ë§Œë“¤ê³  'apiClient.ts' íŒŒì¼ì„ ë§Œë“¤ê³  ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•©ì‹œë‹¤.

```ts
// '/app/utils/apiClient.ts'

import { hc } from "hono/client";
import { AppType } from "../../server";

export const client =
  import.meta.env.MODE === "production"
    ? hc<AppType>(import.meta.env.VITE_API_URL)
    : hc<AppType>("http://localhost:5173/");

export const clientGetTodos = async () => {
  const data = await client.api.todos.$get();
  return data;
};
```

ìœ„ ì½”ë“œë¥¼ ë³´ì‹œë©´ Honoì˜ RPCë¥¼ ì‹¤ì œë¡œ ë§Œë“œëŠ” ë°©ë²•ì´ ë‚˜ì˜¤ëŠ”ë°ìš”.

'hono/client'ê°€ ì œê³µí•´ ì£¼ëŠ” hc í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì•„ê¹Œ export í–ˆë˜ AppTypeì„ ì œë„¤ë¦­ íƒ€ì…ìœ¼ë¡œ ë„£ê³ , ê·¸ë¦¬ê³  ì¤‘ìš”í•œ í•´ë‹¹ API ì„œë²„ ì£¼ì†Œë¥¼ ë„£ì–´ì£¼ë©´ ëì…ë‹ˆë‹¤.

ì €ëŠ” production ëª¨ë“œì¼ ë•ŒëŠ” ì‹¤ì œ ì£¼ì†Œë¡œ ë„£ê³ , ê°œë°œ ëª¨ë“œì¼ ê²½ìš° localhost:5173ìœ¼ë¡œ ë„£ë„ë¡ ì‚¼í•­ì—°ì‚°ìë¥¼ ìœ„ì™€ ê°™ì´ ì ìš©í–ˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œìª½ì—ì„œ ì‚¬ìš©í•  clientGetTodos í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆëŠ”ë°ìš”.

ì´ ì½”ë“œê°€ ë°”ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‹¤í–‰ë˜ë©´ ìœ„ì™€ ê°™ì´ Honoì˜ RPC API Endpointë¥¼ ì‹¤í–‰ì‹œì¼œ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì›ë¦¬ì…ë‹ˆë‹¤.

ìœ„ ì½”ë“œë¥¼ ë³´ì‹œë©´ ìš°ë¦¬ê°€ ë§Œë“  client ê°ì²´ì— ì²´ì¸ ë°©ì‹ìœ¼ë¡œ api, todosë¥¼ ë„£ì—ˆìŠµë‹ˆë‹¤.

ì™œ 'api.todos'í•˜ê³  ê·¸ ë‹¤ìŒì— "$get()" ë©”ì„œë“œë¥¼ ì‹¤í–‰í–ˆëƒë©´ ìš°ë¦¬ê°€ ì•„ê¹Œ Honoì˜ API Endpointë¥¼ ë§Œë“¤ ë•Œ ê²½ë¡œê°€ ë°”ë¡œ api í´ë” ë°‘ì— todos í´ë” ë°‘ì˜ index.ts íŒŒì¼ì´ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì‹¤ì œë¡œ ë¸Œë¼ìš°ì €ì—ì„œë„ "http://localhost:5173/api/todos"í•´ë„ ë˜‘ê°™ì´ ì‘ë™í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ ì‹¤ì œ ë¸Œë¼ìš°ì €ì˜ ê²½ë¡œëª…ëŒ€ë¡œ client ë’¤ì— ë©”ì„œë“œ ì²´ì´ë‹ ë°©ì‹ìœ¼ë¡œ ë¼ìš°íŒ… ì£¼ì†Œë¥¼ ë„£ì–´ì£¼ê³  ë§ˆì§€ë§‰ì— ì›í•˜ëŠ” GET ë©”ì„œë“œë¥¼ ì§€ì •í•˜ëŠ” ê²ë‹ˆë‹¤.

ë§Œì•½ POST ë©”ì„œë“œë¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•˜ë©´ ë˜ê² ì£ .

`client.api.todos.$post()`

ê·¸ë¦¬ê³  ì¤‘ìš”í•œê±°ëŠ” $get í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ì•¼ í•œë‹¤ëŠ” ê²ë‹ˆë‹¤.

ê·¸ë˜ì„œ $get í•¨ìˆ˜ëª… ë’¤ì— '()' ê´„í˜¸ë¥¼ ë¶™í˜€ í•´ë‹¹ $get í•¨ìˆ˜ë¥¼ ì‹¤í–‰(invoke) ì‹œì¼°ìŠµë‹ˆë‹¤.

ì´ì œ apiClient ìœ í‹¸ë¦¬í‹° íŒŒì¼ì˜ ì‘ì„±ì´ ëë‚¬ìœ¼ë©´ ì´ ë‹¤ìŒì—ëŠ” ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ìª½ì—ì„œ todos ë¼ìš°íŒ…ì„ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ê·¸ ì•ì— ë¨¼ì €, routes í´ë” ë°‘ì˜ '_index.tsx' íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•´ì„œ ë©”ì¸ í˜ì´ì§€ë¥¼ ì¡°ê¸ˆ ê°„ë‹¨í•˜ê²Œ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.

```ts
import type { MetaFunction } from "@remix-run/cloudflare";

export const meta: MetaFunction = () => {
  return [
    { title: "New Remix App" },
    { name: "description", content: "Welcome to Remix!" },
  ];
};

export default function Index() {
  return (
    <div className="flex h-screen items-center justify-center">
      <div className="flex flex-col items-center gap-16">
        <header className="flex flex-col items-center gap-9">
          <h1 className="leading text-2xl font-bold text-gray-800 dark:text-gray-100">
            Welcome to <span className="sr-only">Remix</span>
          </h1>
          <div className="h-[144px] w-[434px]">
            <img
              src="/assets/logo-light.png"
              alt="Remix"
              className="block w-full dark:hidden"
            />
            <img
              src="/assets/logo-dark.png"
              alt="Remix"
              className="hidden w-full dark:block"
            />
          </div>
        </header>
        <nav className="flex flex-col items-center justify-center gap-4 rounded-3xl border border-gray-200 p-6 dark:border-gray-700">
          <a
            className="group flex items-center gap-3 self-stretch p-3 leading-normal text-blue-700 hover:underline dark:text-blue-500"
            href="/todos"
            rel="noreferrer"
          >
            Go to Todos
          </a>
        </nav>
      </div>
    </div>
  );
}
```

ìœ„ì™€ ê°™ì´ ë©”ì¸ ë¼ìš°íŒ…ì„ ë°”ê¾¸ë©´ ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨í•œ ë©”ì¸ í˜ì´ì§€ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEiYWTViPOkP2wrd2VQqFNgu3VxZcXwMrflWHqtvXESdq4aAs_ZS673L8RiCLCirwDqv_8MVPOC6meo-bVYhkQ9kT60bEX4oOOjF6Wes8aggTG0A_s_eZ3GCl-L78GRZeZhGhqfSExNQn2DYWYwg_E7hLGSOc1WbihM6XQl0oKViIOfpYtBzyL67owowAS8)

ì´ì œ ë³¸ê²©ì ì¸ todos ì•± êµ¬í˜„ì— ë“¤ì–´ê°€ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

---

## todos ë¼ìš°íŒ… êµ¬í˜„

todos ì•±ì´ë‹ˆê¹Œ todos ë¼ëŠ” ë¼ìš°íŒ…ì„ ë§Œë“¤ì–´ì•¼ê² ì£ .

Remixì—ì„œ ë¼ìš°íŒ…ì€ ê°„ë‹¨í•©ë‹ˆë‹¤.

app í´ë” ë°‘ì˜ routes í´ë” ë°‘ì— í´ë”ëª…ì´ë“  íŒŒì¼ì´ë¦„ì´ë“  ì ìœ¼ë©´ ê·¸ê²Œ ë¼ìš°íŒ…ì´ ë©ë‹ˆë‹¤.

app í´ë” ë°‘ì— ìˆëŠ” routes í´ë”ì— todos.tsx íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ë§Œë“­ì‹œë‹¤.

ì°¸ê³ ë¡œ, UIìª½ì€ [shadcn/ui](https://ui.shadcn.com/)ë¥¼ ì‚¬ìš©í•´ì„œ ì ìš©í–ˆìŠµë‹ˆë‹¤.

```ts
// '/app/routes/todos.tsx'

import type { LoaderFunctionArgs, MetaFunction } from "@remix-run/cloudflare";
import { useLoaderData } from "@remix-run/react";

import { Card, CardContent } from "~/components/ui/card";
import { Checkbox } from "~/components/ui/checkbox";

import { Todo } from "server/api/todos/model";
import { clientGetTodos } from "~/utils/apiClient";

export const meta: MetaFunction = () => {
  return [{ title: "Todo My App" }];
};

export const loader = async ({ context }: LoaderFunctionArgs) => {
  const res = await clientGetTodos();
  return res;
};

// Todo Card
const TodoItem = ({ todo }: { todo: Todo }) => {
  return (
    <Card className="mb-4 hover:shadow-md transition-shadow duration-200">
      <CardContent className="flex items-center p-4">
        <Checkbox id={`todo-${todo.id}`} className="mr-4" />
        <div className="flex-grow">
          <label
            htmlFor={`todo-${todo.id}`}
            className="opacity-100 text-lg font-medium leading-none text-gray-700"
          >
            {todo.title}
          </label>
        </div>
      </CardContent>
    </Card>
  );
};

const Todos = () => {
  const todos = useLoaderData<typeof loader>();

  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-white text-gray-800 p-4 shadow-sm">
        <div className="container mx-auto">
          <a href="/todos" className="text-2xl font-bold">
            My TODO App
          </a>
        </div>
      </header>
      <main className="container mx-auto py-8 px-4">
        <div className="w-full max-w-4xl mx-auto">
          <div className="space-y-4">
            {Array.isArray(todos) &&
              todos.map((todo) => <TodoItem key={todo.id} todo={todo} />)}
          </div>
        </div>
      </main>
    </div>
  );
};
export default Todos;
```

ê°œë°œ ì„œë²„ë¥¼ ì‹¤í–‰í•´ë³´ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEgmzq9lmMVJU3vSmfOjf6tuluLRnERoi8mrgboetdeNTK8Kzj-IGluYLnLgVDqb35a7Opal7SJSIwtRtU_6FYjcSqBGzm6OiV5UQ3k4IueZ5w9m-LQ5wRNqJdzaCREu5UuacA6k252qLUOzlxvrZBEybOPaj4eNMBPVEvPqDxDITH7YuKtRZzDiYKyZrTE)

ì–´ë–¤ê°€ìš”?

Hono RPCë¥¼ ì´ìš©í•´ì„œ getTodos ë°±ì—”ë“œ í•¨ìˆ˜ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì†ì‰½ê²Œ client ê°ì²´ë¥¼ ì´ìš©í•´ì„œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.

ì‹¬ì§€ì–´ Hono RPCì˜ $get ë©”ì„œë“œëŠ” React Queryë¥¼ êµ¬í˜„í•  ë•Œ ì œê³µí•˜ëŠ” fetch í•¨ìˆ˜ì— ê·¸ëŒ€ë¡œ ë„£ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

Hono ê³µì‹ í™ˆí˜ì´ì§€ë¥¼ ë³´ì‹œë©´ ì‚¬ìš©ë°©ë²•ì´ ë‚˜ì˜¤ëŠ”ë°ìš”, ì°¸ê³  í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

todos.tsx íŒŒì¼ì˜ ë‚´ìš©ì€ loader í•¨ìˆ˜ì—ì„œ ë°±ì—”ë“œìª½ ë°ì´í„°ë¥¼ ì–»ì€ ë‹¤ìŒ í´ë¼ì´ì–¸íŠ¸ ìª½ ì½”ë“œì—ì„œëŠ” useLoaderData í›…ì„ ì´ìš©í•´ì„œ ê·¸ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ìª½ UIì— ë¿Œë ¤ì£¼ëŠ” ì „í˜•ì ì¸ React ì½”ë“œì…ë‹ˆë‹¤.

ê¸°ë³¸ì ì¸ ì‚¬ìš©ë°©ë²•ì„ ìµíˆì…¨ìœ¼ë©´ ë³¸ê²©ì ìœ¼ë¡œ Inputê³¼ Deleteê·¸ë¦¬ê³  completed ì²´í¬ë°•ìŠ¤ í† ê¸€ê¹Œì§€ todos.tsx íŒŒì¼ì— êµ¬í˜„í•´ì•¼ í•˜ëŠ”ë°ìš”.

ê·¸ëŸ¼ ë³¸ê²©ì ìœ¼ë¡œ ì‹œì‘í•´ ë³´ê² ìŠµë‹ˆë‹¤.

---

## update êµ¬í˜„í•˜ê¸°

ì´ë²ˆì— êµ¬í˜„í•  UI ë¡œì§ì€ ì²´í¬ ë°•ìŠ¤ë¥¼ ëˆ„ë¥´ë©´ Todo ì•±ì˜ completed ê°’ì´ falseê°€ ë˜ë©´ì„œ todo íƒ€ì´í‹€ì˜ ê¸€ìê°€ line-through ë°©ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ê²Œ í•˜ëŠ”ê²Œ ìµœì¢… ëª©ì ì…ë‹ˆë‹¤.

ì¼ë‹¨ ì´ ë°©ì‹ì€ í´ë¼ì´ì–¸íŠ¸ìª½ì—ì„œ ë‹¨ìˆœí•˜ê²Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë§Œì„ ì´ìš©í•´ì„œ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.

ì˜ˆì „ React ì½”ë“œ ì‘ì„±ë°©ì‹ì´ë‘ ê°™ìŠµë‹ˆë‹¤.

ë¨¼ì €, UIìª½ ì½”ë“œë¥¼ ì†ë³´ê² ìŠµë‹ˆë‹¤.

TodoItem ì»´í¬ë„ŒíŠ¸ë¥¼ ì•„ë˜ì™€ ê°™ì´ ê³ ì¹©ì‹œë‹¤.

```ts
// Todo Card
const TodoItem = ({ todo }: { todo: Todo }) => {
  const [isCompleted, setIsCompleted] = useState(todo.completed);

  const handleCheckboxChange = async (checked: boolean) => {
    await client.api.todos[":id"].$put({
      json: {
        title: todo.title,
        completed: isCompleted,
      },
      param: {
        id: todo.id.toString(),
      },
    });

    setIsCompleted(isCompleted === 0 ? 1 : 0);
  };

  return (
    <Card className="mb-4 hover:shadow-md transition-shadow duration-200">
      <CardContent className="flex items-center p-4">
        <Checkbox
          id={`todo-${todo.id}`}
          checked={isCompleted === 0 ? false : true}
          onCheckedChange={handleCheckboxChange}
          className="mr-4"
        />
        <div className="flex-grow">
          <label
            htmlFor={`todo-${todo.id}`}
            className={`
              opacity-100 text-lg font-medium leading-none ${
                isCompleted ? "line-through text-gray-400" : "text-gray-700"
              }`}
          >
            {todo.title}
          </label>
        </div>
      </CardContent>
    </Card>
  );
};
```

ë­”ê°€ ë³µì¡í•œë° ì•„ì£¼ ì‰¬ìš´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œì…ë‹ˆë‹¤.

ë¨¼ì €, UI ìª½ ë³´ì‹œë©´ label íƒœê·¸ê°€ 'isCompleted'ë¼ëŠ” state ê°’ì— ë”°ë¼ 'line-through' ê°€ ì ìš©ë˜ëƒ ì•ˆë˜ëƒë¡œ ì‘ë™í•©ë‹ˆë‹¤.

Checkbox ìª½ì—ë„ 'checked' ê°’ì„ isCompleted'ë¼ëŠ” state ê°’ì— ë”°ë¼ ì ìš©ì‹œì¼°ìŠµë‹ˆë‹¤.

ì´ì œ onCheckedChange í•¸ë“¤ëŸ¬ì¸ handleCheckboxChange í•¨ìˆ˜ì— ì˜í•´ DBìª½ì„ ì œì–´í•˜ëŠ” ì½”ë“œë¥¼ ë´ì•¼í•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```ts
await client.api.todos[":id"].$put({
      json: {
        title: todo.title,
        completed: isCompleted,
      },
      param: {
        id: todo.id.toString(),
      },
    });
```

ìœ„ ì½”ë“œë¥¼ ë³´ë‹ˆê¹Œ put ë©”ì„œë“œë¥¼ ì´ìš©í•´ì„œ completed ê°’ì„ ì—…ë°ì´íŠ¸ í•˜ê³  ìˆë„¤ìš”.

ê·¸ëŸ°ë° todos ë‹¤ìŒì— ë¬¸ìì—´ ë°°ì—´ì„ ë„£ê³  ìˆìŠµë‹ˆë‹¤.

ì´ê²Œ ë°”ë¡œ URL paramsë¥¼ ë„£ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

ì—¬ê¸°ì„œëŠ” 'id'ë¼ëŠ” paramsë¥¼ ë„£ê³  ìˆëŠ”ê±°ì£ .

idëŠ” TodoItem ì»´í¬ë„ŒíŠ¸ê°€ propsë¡œ ë°›ê³  ìˆëŠ” Todoê°ì²´ì— ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ê·¸ ê°’ì€ ë°”ë¡œ 'todo.id'ê°€ ë˜ëŠ”ê±°ì£ .

í˜„ì¬ SQlite3 Tableì—ëŠ” idëŠ” integer ê°’ì…ë‹ˆë‹¤.

ê·¸ë˜ì„œ URLë¡œ ë„˜ê²¨ì¤„ ë•ŒëŠ” string ê°’ìœ¼ë¡œ ê³ ì³ì•¼í•©ë‹ˆë‹¤.

'todo.id.toString()' ì´ë ‡ê²Œ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

$put ë©”ì„œë“œì—ëŠ” json ê°’ê³¼ param ê°’ì„ ê°ì²´ë¡œ ë”°ë¡œ ë„£ì—ˆëŠ”ë°ìš”.

ì´ json ê°’ê³¼ param ê°’ì´ ì‹¤ì œ Hono ë°±ì—”ë“œì—ì„œ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ë„ ìœ ì‹¬íˆ ì‚´í´ë´ì•¼ í•©ë‹ˆë‹¤.

---

ì´ì œ Honoë¥¼ ì´ìš©í•œ ë°±ì—”ë“œ ì½”ë“œì—ì„œ put ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼ ê² ìŠµë‹ˆë‹¤.

ë‹¤ì‹œ 'server/api/todos/index.ts' íŒŒì¼ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì¶”ê°€í•©ì‹œë‹¤.

```ts
// 'server/api/todos/index.ts'

import { Hono } from "hono";
import { getTodos, updateTodo } from "./model";
import { zValidator } from "@hono/zod-validator";

// RPCë¥¼ ìœ„í•´ì„œëŠ” new Hono<>().get í˜•ì‹ìœ¼ë¡œ ë¶™í˜€ì„œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
const api_todos = new Hono<{ Bindings: Env }>()
  .get("/todos", async (c) => {
    const todos = await getTodos(c.env.DB);
    return c.json(todos);
  })
  .put("/todos/:id", zValidator("json", TodoSchema), async (c) => {
    const id = c.req.param("id");
    const validatedData = c.req.valid("json");
    // console.log(validatedData);

    await updateTodo(c.env.DB, parseInt(id), {
      title: validatedData.title,
      completed: validatedData.completed === 0 ? 1 : 0,
    });

    return c.json({ ok: true });
  });

export default api_todos;
```

zValidatorëŠ” ê·¸ëƒ¥ import í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

ì´ì œ í•„ìš”í•œê±´ model í´ë”ì— ìˆëŠ” updateTodo í•¨ìˆ˜ì¸ë°ìš”.

'model.ts' íŒŒì¼ì—ì„œ ì•„ë˜ì™€ ê°™ì´ updateTodo í•¨ìˆ˜ë¥¼ ë§Œë“­ì‹œë‹¤.

```ts
export interface UpdateTodoType {
  title: string;
  completed: number;
}

export const updateTodo = async (
  DB: D1Database,
  id: number,
  param: UpdateTodoType
): Promise<void> => {
  const todo = await DB.prepare("SELECT * FROM Todos where id = ?")
    .bind(id)
    .first<Todo>();

  if (!todo) {
    console.error(`Todo with id ${id} not found.`);
    return;
  }

  // ì—…ë°ì´íŠ¸í•  í•­ëª© ì •ì˜ (ê¸°ì¡´ ê°’ê³¼ ìƒˆë¡œìš´ ê°’ ë³‘í•©)
  const updatedTodo = {
    ...todo,
    ...param,
  };

  // D1 DBì—ì„œ í•´ë‹¹ idì˜ Todo í•­ëª© ì—…ë°ì´íŠ¸
  const result = await DB.prepare(
    "UPDATE Todos SET title = ?, completed = ? where id = ?"
  )
    .bind(updatedTodo.title, updatedTodo.completed, id)
    .run();
};
```

ë¨¼ì €, updateë¥¼ ìœ„í•´ì„œëŠ” Cloudflare D1 DBì—ì„œ bind() ë©”ì„œë“œë¥¼ ì´ìš©í•´ì„œ idì— í•´ë‹¹ë˜ëŠ” todoë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.

ë§Œì•½ í•´ë‹¹ idì— ëŒ€í•œ todo ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ë¥¼ ë‚´ë©´ì„œ ê·¸ëƒ¥ return ë˜ê³ ìš”.

ë§Œì•½ í•´ë‹¹ idì— ëŒ€í•œ todo ê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸í•˜ê²Œ ë©ë‹ˆë‹¤.

SQlite3 Update í•˜ëŠ” StatementëŠ” ë”°ë¡œ ê³µë¶€í•˜ì…”ì•¼ í•  ê²ë‹ˆë‹¤.

ì´ì œ ì²´í¬ë°•ìŠ¤ë¥¼ ëˆŒëŸ¬ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEj67bQmm_7EXP-0HlIL6cAN9OPIz0bk3EZueJZsBwCMwSa5fjy-Hvf7IR04odkH9dj3oyjoAk-jSUZPxH36t6mygl40EBGvsXvevzHbB-QwlF8QLq_KDWNnVrhUHwqySclmpJOdF-VJGhng5jHjhdiqihA7JHcRjzUEM6l2BhzKOCEJH3IxnBvSW0mKBUg)

ì–´ë–¤ê°€ìš”?

Update ë¡œì§ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

Hono RPCë¥¼ ì´ìš©í•œ ë²¡ì—”ë“œ ì½”ë“œ ì ‘ê·¼ì— ëŒ€í•´ ì¡°ê¸ˆì€ ì´í•´í•˜ì‹¤ìˆ˜ ìˆì£ ?

---

## Create êµ¬í˜„í•˜ê¸°

ì´ì œë¶€í„°ëŠ” POST ë©”ì„œë“œì¸ë°ìš”.

POST ë©”ì„œë“œê°€ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ë©”ì„œë“œë¼ì„œ ì—¬ê¸°ì„œ ë¶€í„°ëŠ” ê¸´ì¥í•´ì•¼í•  ê²ë‹ˆë‹¤.

ë¨¼ì €, model íŒŒì¼ì—ì„œ ì•„ë˜ì™€ ê°™ì´ createTodo í•¨ìˆ˜ë¥¼ ë¨¼ì € ë§Œë“¤ê² ìŠµë‹ˆë‹¤.

```ts
// 'server/api/todos/model.ts'

export interface CreateTodoType {
  title: string;
}

export const createTodo = async (
  DB: D1Database,
  param: CreateTodoType
): Promise<Todo> => {
  try {
    // D1 DBì— ìƒˆë¡œìš´ Todo í•­ëª© ì‚½ì…
    const result = await DB.prepare("INSERT INTO Todos (title) VALUES (?)")
      .bind(param.title)
      .run();
    // console.log(result);


    // {
    //   success: true,
    //   meta: {
    //     served_by: 'miniflare.db',
    //     duration: 0,
    //     changes: 1,
    //     last_row_id: 9,
    //     changed_db: true,
    //     size_after: 16384,
    //     rows_read: 1,
    //     rows_written: 2
    //   },
    //   results: []
    // }

    // ì‚½ì…ëœ í–‰ì˜ ID ê°€ì ¸ì˜¤ê¸°
    // const id = result.meta.last_row_id;

    if (!result.success) {
      throw new Error("Failed to retrieve the ID of the inserted Todo.");
    }

    // ìƒˆë¡œ ì‚½ì…ëœ Todo ê°ì²´ ìƒì„±
    const newTodo: Todo = {
      id: result.meta.last_row_id,
      title: param.title,
      completed: 0,
    };

    return newTodo;
  } catch (error) {
    console.error("Failed to create todo in D1 DB", error);
    throw new Error("Todo creation failed");
  }
};
```

ìœ„ ì½”ë“œë¥¼ ë³´ì‹œë©´ ë¨¼ì €, CreateTodoType íƒ€ì…ì„ interfaceë¡œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  createTodo í•¨ìˆ˜ë¡œ ë“¤ì–´ê°€ ë³´ë©´, D1 DBì— ìƒˆë¡œìš´ Todo í•­ëª© ì‚½ì…í•˜ëŠ” SQL ëª…ë ¹ì„ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ ì‹¤í–‰í•˜ë©´ result ê°’ì— ê°ì²´ê°€ ë°˜í™˜ë˜ëŠ”ë°ìš”.

ìœ„ ì½”ë“œ ì£¼ì„ì— ë³´ì‹œë©´ ê·¸ ê°ì²´ ê°’ì˜ ì˜ˆê°€ ë‚˜ì˜µë‹ˆë‹¤.

ì—¬ê¸°ì„œ ì¤‘ìš”í•˜ê²Œ ë´ì•¼í• ê²Œ ë°”ë¡œ INSERT ì¿¼ë¦¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ë°©ê¸ˆ ì‹¤í–‰í•œ ê°’ì˜ idë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”ë°ìš”.

ë°”ë¡œ 'result.meta.last_row_id' ê°’ì…ë‹ˆë‹¤.

ì´ê²Œ ì™œ ì¤‘ìš”í•˜ëƒë©´ ë³´í†µ INSERTí•˜ê³  ë‚˜ë©´ ì„±ê³µì ìœ¼ë¡œ INSERTê°€ ëœ í›„ì˜ ê°’ì„ ë‹¤ì‹œ ì‚¬ìš©í•´ì•¼í•  ë•Œê°€ ìˆëŠ”ë°ìš”.

ì´ë ‡ë•Œ ì•„ì£¼ ìœ ìš©í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ ì‹¤ì œë¡œ ìœ„ ì½”ë“œì—ì„œëŠ” ìƒˆë¡œ ì‚½ì…ëœ Todo ê°ì²´ ìƒì„±ë¥¼ ìƒì„±í•˜ëŠ”ë°ìš”.

ì™œ Todo ê°ì²´ë¥¼ ìƒì„±í• ê¹Œìš”?

ì™œëƒí•˜ë©´ SELECT ë¬¸ìœ¼ë¡œ Todo ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ë©´ í•œ ë²ˆ ë” SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì•¼í•˜ê¸° ë•Œë¬¸ì´ì£ .

ìš°ë¦¬ê°€ ìƒˆë¡œìš´ Todo ê°ì²´ë¥¼ UIë¡œ ëŒë ¤ì¤˜ì•¼í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ Todo ê°ì²´ì— í•„ìš”í•œê±°ëŠ” title, completed ê°’ê³¼ idì…ë‹ˆë‹¤.

title, completed ê°’ì€ createTodo í•¨ìˆ˜ë¥¼ ë§Œë“¤ ë•Œ ë²Œì¨ ì œê³µë˜ì–´ì§„ê±°ë¼ ì•Œê³  ìˆê³ , idê°’ë§Œ ì•Œë©´ ë˜ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ 'meta.last_row_id' ê°’ìœ¼ë¡œ í•´ë‹¹ idê°’ì„ ì§€ì •í•˜ë©´ ìš°ë¦¬ê°€ ê¶ê·¹ì ìœ¼ë¡œ ì›í•˜ëŠ” ìƒˆë¡œìš´ newTodo ê°’ì„ ì•Œ ìˆ˜ ìˆëŠ”ê±°ì£ .

ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ í•´ë‹¹ newTodo ê°ì²´ë¥¼ ë¦¬í„´í•˜ë©´ UIì—ì„œ í•´ë‹¹ newTodoë¥¼ í™”ë©´ì— ë¿Œë ¤ì£¼ë©´ ë©ë‹ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ ë¶ˆí•„ìš”í•œ SQL ì‹¤í–‰ì´ í•œë²ˆìœ¼ë¡œ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì— ì´ ë°©ì‹ì€ ì•„ì£¼ ì¤‘ìš”í•©ë‹ˆë‹¤.

ì´ì œ UIìª½ì„ ë³¼ê¹Œìš”?

'todos.tsx' íŒŒì¼ì—ì„œ inputì„ ìœ„í•œ Formì„ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ê°„ë‹¨í•˜ê²Œ UIë¥¼ ì§œê² ìŠµë‹ˆë‹¤.

ë¨¼ì €, 'shadcn/ui'ì˜ input ì»´í¬ë„ŒíŠ¸ì™€ ì•„ì´ì½˜ì„ ìœ„í–‡ 'lucide-react' íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.

```sh
$ npx shadcn@latest add input

$ npm i lucide-react
```

ê·¸ë¦¬ê³  Pending UIë¥¼ ì²˜ìŒë¶€í„° êµ¬í˜„í•´ ë³¼ê»€ë°ìš”.

ê·¸ë˜ì„œ input í¼ì„ ìœ„í•´ Remixê°€ ì œê³µí•˜ëŠ” 'Form' ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ê²ë‹ˆë‹¤.

ì‹¤ì œ ì½”ë“œë¥¼ ë³´ì‹œì£ .

ì»´í¬ë„ŒíŠ¸ë¡œ ë³´ì‹œë©´ Todos ì»´í¬ë„ŒíŠ¸ë§Œ ë³´ì‹œë©´ ë©ë‹ˆë‹¤.

```ts
const Todos = () => {
  const todos = useLoaderData<typeof loader>();

  const navigation = useNavigation();

  const isAdding =
    navigation.state === "submitting" &&
    navigation.formData?.get("_action") === "create";

  let formRef = useRef<HTMLFormElement>(null);
  let inputRef = useRef<HTMLInputElement>(null);

  useEffect(() => {
    if (!isAdding) {
      formRef.current?.reset();
      inputRef.current?.focus();
    }
  }, [isAdding]);

  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-white text-gray-800 p-4 shadow-sm">
        <div className="container mx-auto">
          <a href="/todos" className="text-2xl font-bold">
            My TODO App
          </a>
        </div>
      </header>
      <main className="container mx-auto py-8 px-4">
        <div className="w-full max-w-4xl mx-auto">
          
          {/* ìƒˆë¡œ ì¶”ê°€ëœ ì½”ë“œ */}
          <Form ref={formRef} replace method="POST">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-2xl font-bold text-gray-700">TODO ë¦¬ìŠ¤íŠ¸</h2>
              <div className="flex space-x-3">
                <Input
                  type="text"
                  name="title"
                  placeholder="title"
                  required
                  ref={inputRef}
                />
                <Button
                  type="submit"
                  name="_action"
                  value="create"
                  disabled={isAdding}
                  className="bg-black text-white hover:bg-gray-800 transition-colors duration-200 rounded-xl px-4 py-2"
                >
                  <PlusCircle className="mr-2 h-4 w-4" />
                  {isAdding ? "ì¶”ê°€ ì¤‘" : "TODO ì¶”ê°€í•˜ê¸°"}
                </Button>
              </div>
            </div>
          </Form>
          <div className="space-y-4">
            {Array.isArray(todos) &&
              todos.map((todo) => <TodoItem key={todo.id} todo={todo} />)}
          </div>
        </div>
      </main>
    </div>
  );
};

export default Todos;
```

ìœ„ì™€ ê°™ì´ ì¡°ê¸ˆ ì–´ë µê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆëŠ”ë°ìš”.

Pending UIë¥¼ ìœ„í•´ì„œ RemixëŠ” useNavigation í›…ì„ ì§€ì›í•´ ì¤ë‹ˆë‹¤.

ì´ í›…ì€ Formì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì²´í¬í•´ì„œ ì•Œ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ”ë°ìš”.

```ts
const navigation = useNavigation();
```

ìœ„ì™€ ê°™ì´ useNavigation í›…ì„ navigationìœ¼ë¡œ ì§€ì •í•˜ë©´ ì´ì œ navigation ê°ì²´ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ Form ìƒíƒœë¥¼ ì•Œ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

```ts
const isAdding =
    navigation.state === "submitting" &&
    navigation.formData?.get("_action") === "create";
```

ìœ„ì™€ ê°™ì´ isAdding ì´ë¼ëŠ” boolean ê°’ì„ ë§Œë“¤ì–´ ë†“ìœ¼ë©´ í˜„ì¬ UIê°€ ìƒˆë¡œìš´ Todoë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë²„íŠ¼ì„ ëˆŒë €ëŠ”ì§€ ì•Œ ìˆ˜ ìˆëŠ”ê²ë‹ˆë‹¤.

ê·¸ë¦¬ê³  í•´ë‹¹ Pending UIëŠ” ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ì— ì ìœ¼ë©´ ë©ë‹ˆë‹¤.

```ts
<Button
  type="submit"
  name="_action"
  value="create"
  disabled={isAdding}
  className="bg-black text-white hover:bg-gray-800 transition-colors duration-200 rounded-xl px-4 py-2"
>
  <PlusCircle className="mr-2 h-4 w-4" />
  {isAdding ? "ì¶”ê°€ ì¤‘" : "TODO ì¶”ê°€í•˜ê¸°"}
</Button>
```

ìœ„ì™€ ê°™ì´ Button ì»´í¬ë„ŒíŠ¸ì— isAdding ê°’ì„ ì´ìš©í•´ì„œ Pending UIë¥¼ êµ¬í˜•í–ˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ì¤‘ìš”í•œê²Œ Button ì»´í¬ë„ŒíŠ¸ëŠ” HTMLì˜ input íƒœê·¸ì¸ë°ìš”.

ì´ íƒœê·¸ì˜ ì´ë¦„(name)ì„ '_action'ì´ë¼ê³  í•˜ê³  value ê°’ì„ 'create'ë¼ê³  í–ˆìŠµë‹ˆë‹¤.

ì´ ë°©ì‹ì„ Remixì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©€í‹° Form POSTì— ëŒ€ì‘í•˜ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ì‹ì¸ë°ìš”.

ë‚˜ì¤‘ì— DELETEë¥¼ ìœ„í•´ì„œë„ Formì„ POSTí•  ë•Œ POST ë©”ì„œë“œê°€ 'create'ì¸ì§€ 'delete'ì¸ì§€ êµ¬ë¶„í•˜ê¸° ìœ„í•´ì„œ ì…ë‹ˆë‹¤.

formRef, inputRefëŠ” ì–´ë””ì— ì“°ëŠ”ì§€ ë‹¤ë“¤ ì•„ì‹¤ê²ë‹ˆë‹¤.

Todoë¥¼ ìƒˆë¡œ ë§Œë“¤ê³  Input í¼ì„ í´ë¦¬ì–´í•˜ê³  ê·¸ë¦¬ê³  ì»¤ì„œë¥¼ ìœ„ì¹˜ì‹œí‚¤ê¸° ìœ„í•œ ì½”ë“œì…ë‹ˆë‹¤.

Reactì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ UIë¼ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.

---

## Remixì˜ action í•¨ìˆ˜ ë§Œë“¤ê¸°

RemixëŠ” POST ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ë©´ ê¼­ action í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ë°ìš”.

ì°¸ê³ ë¡œ RemixëŠ” GET, POST ë©”ì„œë“œë§Œ ì‚¬ìš©í•˜ë¼ê³  ê¶Œì¥í•©ë‹ˆë‹¤.

ì™œëƒí•˜ë©´ action í•¨ìˆ˜ê°€ POST ë©”ì„œë“œë§Œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì´ì£ .

ë§Œì•½ DELETE ë©”ì„œë“œë‚˜ PUT ë©”ì„œë“œë¥¼ ë°œìƒì‹œì¼œë³´ì‹œë©´ ì—ëŸ¬ë©”ì‹œì§€ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

ë‚˜ì¤‘ì— Todo ì•± ì§€ìš°ê¸° ë¶€ë¶„ì—ì„œ ì‹¤ì œë¡œ DELETE ë©”ì„œë“œë¥¼ ë°œìƒì‹œì¼œ ë´…ì‹œë‹¤.

ì—¬ê¸°ì„œëŠ” ì¼ë‹¨ì€ POST ë©”ì„œë“œë¥¼ ì´ìš©í•´ì„œ Formì„ ì œì¶œí–ˆê¸° ë•Œë¬¸ì— RemixëŠ” íŠ¹ì„±ìƒ action í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”ë°ìš”.

ì´ action í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ ë´…ì‹œë‹¤.

action í•¨ìˆ˜ëŠ” loader í•¨ìˆ˜ ë°‘ì— ë‘ì‹œë©´ ë©ë‹ˆë‹¤.

```ts
export const loader = async ({ context }: LoaderFunctionArgs) => {
  const res = await clientGetTodos();
  return res;
};

export const action = async ({ request }: ActionFunctionArgs) => {
  const formData = await request.formData();
  const { _action, ...values } = Object.fromEntries(formData);

  // if (_action === "delete") {
  //   await clientDeleteTodo(values);
  // }

  if (_action === "create") {
    await clientCreateTodo(values);
  }

  return null;
};
```

ìœ„ì™€ ê°™ì´ action í•¨ìˆ˜ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì•„ê¹Œ '_action' ê°’ì„ ì§€ì •í•œ ì´ìœ ê°€ ìœ„ ì½”ë“œì— ìˆëŠ”ë°ìš”.

'_action' ê°’ì´ 'create'ì™€ 'delete'ì¼ ê²½ìš° ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ êµ¬ë¶„ì‹œí‚¤ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤.

ì¼ë‹¨ì€ 'delete' ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ì‘ì„±í•  ê±°ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ ì£¼ì„ì²˜ë¦¬í•´ ë†“ìì‹œë‹¤.

ì´ì œ clientCreateTodo í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì•¼ ê² ë„¤ìš”.

'apiClient.ts' íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤.

```ts
export const clientCreateTodo = async (values: any) => {
  await client.api.todos.$post({
    form: {
      title: values.title,
    },
  });
};
```

ìœ„ì™€ ê°™ì´ ë„£ìœ¼ë©´ VS Codeê°€ $post ê°€ ì—†ë‹¤ê³  í•˜ëŠ”ë°ìš”.

ì™œëƒí•˜ë©´ Hono ì„œë²„ìª½ì— $post ë©”ì„œë“œë¥¼ ì‘ì„±ì•ˆí–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì´ì œ 'server/api/todo/index.ts' íŒŒì¼ì— post ë©”ì„œë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.

```ts
import { Hono } from "hono";
import { createTodo, getTodos, TodoSchema, updateTodo } from "./model";
import { zValidator } from "@hono/zod-validator";

// RPCë¥¼ ìœ„í•´ì„œëŠ” new Hono<>().get í˜•ì‹ìœ¼ë¡œ ë¶™í˜€ì„œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
const api_todos = new Hono<{ Bindings: Env }>()
  .get("/todos", async (c) => {
    const todos = await getTodos(c.env.DB);
    return c.json(todos);
  })
  .put("/todos/:id", zValidator("json", TodoSchema), async (c) => {
    const id = c.req.param("id");
    const validatedData = c.req.valid("json");
    // console.log(validatedData);

    await updateTodo(c.env.DB, parseInt(id), {
      title: validatedData.title,
      completed: validatedData.completed === 0 ? 1 : 0,
    });

    return c.json({ ok: true });
  })
  .post("/todos", zValidator("form", TodoSchema), async (c) => {
    const validatedData = c.req.valid("form");
    // console.log(validatedData);
    await createTodo(c.env.DB, validatedData);
    return c.json({ ok: true });
  });

export default api_todos;
```

post ë©”ì„œë“œë¥¼ put ë©”ì„œë“œ ë‹¤ìŒì— ì¶”ê°€ì‹œì¼°ìŠµë‹ˆë‹¤.

post ë©”ì„œë“œì˜ ì£¼ì†ŒëŠ” '/todos' ì£¼ì†Œê°€ ë˜ê³  HTTP ë¦¬í€˜ìŠ¤íŠ¸(Request)ê°€ POST ì¼ ê²½ìš° ëŒ€ì‘í•˜ëŠ” ì½”ë“œê°€ ë˜ëŠ”ê²ë‹ˆë‹¤.

ì—¬ê¸°ì„œ UIìª½ì—ì„œ form ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ POSTí–ˆê¸° ë•Œë¬¸ì— zValidator í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¹¸ì— 'form'ì´ë¼ê³  ì ì–´ì•¼ í•©ë‹ˆë‹¤.

createTodo í•¨ìˆ˜ëŠ” ì˜ˆì „ì— ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì´ì œ POST ë©”ì„œë“œë¥¼ ìœ„í•œ Hono RPCê°€ ëë‚¬ìŠµë‹ˆë‹¤.

ì´ì œ í…ŒìŠ¤íŠ¸ í•´ë³¼ê¹Œìš”?

![](https://blogger.googleusercontent.com/img/a/AVvXsEgdE_49r6B5HRVY5zoLPiTtVRIfYBDpksFFRdhjiosQibpqKLUHyqNe8dJRq-0U42j862B2JFZ_tQjNVMnInVar7hwydp1_dqcntZb1NYNyFq2eHBP0leXyYj6A8iS0BWeNX3KEUqezX3_i5eBHpjdMZNFe-NQPUZKiIqOJXNAI9SnEMkfHo9Hsr_YMezQ)

![](https://blogger.googleusercontent.com/img/a/AVvXsEhXwO0yPFN5ffa1EoOimt2zqEi70cStH5iPzetMFkOX-TMgl1Va8LygdQmcbOsOrfjvQm1Si_GPnAJgMd2EjKZ-0uvF6eEwaudwsApPflS4Qc8OumGOvYKguKPsxLlk1Tle9i1y2brh4mqFh6GLuo3w1x_3RenjchLoW3my8ZYSw3AR3JifX1eTAzit7lU)

ìœ„ì™€ ê°™ì´ ì•„ì£¼ ì˜ ì‹¤í–‰ë˜ê³  ìˆë„¤ìš”.

---

## Delete êµ¬í˜„í•˜ê¸°

ì´ì œ ë§ˆì§€ë§‰ ë‹¨ê³„ì¸ Delete êµ¬í˜„ì…ë‹ˆë‹¤.

Pending UIë¥¼ ìœ„í•´ì„œ Reactì™€ Remixì˜ í›…ì„ ì¶”ê°€í•´ì„œ Delete êµ¬í˜„ì„ í–ˆìœ¼ë‹ˆ ì£¼ì˜í•´ì„œ ì‚´í´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.

ì—­ì‹œë‚˜ ë¨¼ì €, model.ts íŒŒì¼ì— deleteTodo í•¨ìˆ˜ë¥¼ ë¨¼ì € ë§Œë“¤ê² ìŠµë‹ˆë‹¤.

```ts
export const deleteTodo = async (DB: D1Database, id: number) => {
  try {
    const result = await DB.prepare("DELETE FROM Todos Where id = ?")
      .bind(id)
      .run();
    // console.log(`Todo with id ${id} successfully deleted.`);
    // console.log(result);
  } catch (error) {
    console.error("Failed to delete todo in D1 DB", error);
    throw new Error("Todo deletion failed");
  }
};
```

ìœ„ ì½”ë“œë¥¼ ë³´ì‹œë©´ ì´ì œëŠ” ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.

Clientìª½ì„ ìœ„í•œ apiClient.ts íŒŒì¼ì—ë„ ì¶”ê°€í•´ ë´…ì‹œë‹¤.

```ts
export const clientDeleteTodo = async (values: any) => {
  await client.api.todos[":id"].$delete({
    param: {
      id: values.id as string,
    },
  });
};
```

ìœ„ì™€ ê°™ì´ ì…ë ¥í•˜ì‹œë©´ ì—­ì‹œë‚˜ $delete ìª½ì— ì—ëŸ¬ê°€ ë‚˜ì˜¤ëŠ”ë°ìš”.

Honoìª½ì— $deleteë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

'/server/api/todo/index.ts' íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€í•©ì‹œë‹¤.

```ts
import { Hono } from "hono";
import {
  createTodo,
  deleteTodo,
  getTodos,
  TodoSchema,
  updateTodo,
} from "./model";
import { zValidator } from "@hono/zod-validator";

// RPCë¥¼ ìœ„í•´ì„œëŠ” new Hono<>().get í˜•ì‹ìœ¼ë¡œ ë¶™í˜€ì„œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
const api_todos = new Hono<{ Bindings: Env }>()
  .get("/todos", async (c) => {
    const todos = await getTodos(c.env.DB);
    return c.json(todos);
  })
  .put("/todos/:id", zValidator("json", TodoSchema), async (c) => {
    const id = c.req.param("id");
    const validatedData = c.req.valid("json");
    // console.log(validatedData);

    await updateTodo(c.env.DB, parseInt(id), {
      title: validatedData.title,
      completed: validatedData.completed === 0 ? 1 : 0,
    });

    return c.json({ ok: true });
  })
  .post("/todos", zValidator("form", TodoSchema), async (c) => {
    const validatedData = c.req.valid("form");
    // console.log(validatedData);
    await createTodo(c.env.DB, validatedData);
    return c.json({ ok: true });
  })
  .delete("/todos/:id", async (c) => {
    const id = c.req.param("id"); // URL ê²½ë¡œì—ì„œ id ê°€ì ¸ì˜¤ê¸°
    const todo = await getTodo(c.env.DB, parseInt(id));
    if (!todo) {
      return c.json({ message: "not found" }, 404);
    }
    await deleteTodo(c.env.DB, parseInt(id));
    // return c.redirect("/todos");
    return c.json({ ok: true });
  });

export default api_todos;
```

ë§ˆì§€ë§‰ì— delete ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆëŠ”ë°ìš”.

ì—¬ê¸°ì„œëŠ” getTodo í•¨ìˆ˜ë¥¼ í•„ìš”ë¡œ í•˜ë„¤ìš”.

'model.ts' íŒŒì¼ì— Todo í•œê°œë¥¼ ê°€ì ¸ì˜¤ëŠ” ëª©ì ì˜ getTodo í•¨ìˆ˜ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€í•©ì‹œë‹¤.

```ts
export const getTodo = async (
  DB: D1Database,
  id: number
): Promise<Todo | null> => {
  try {
    // SQL ì¿¼ë¦¬ë¡œ íŠ¹ì • idì— í•´ë‹¹í•˜ëŠ” Todo í•­ëª©ì„ ì¡°íšŒ
    const todo = await DB.prepare("SELECT * FROM Todos WHERE id = ?")
      .bind(id)
      .first<Todo>();
    // console.log(todo);

    // ê²°ê³¼ê°€ ì¡´ì¬í•˜ë©´ í•´ë‹¹ Todo ë°˜í™˜, ì—†ìœ¼ë©´ null ë°˜í™˜
    return todo || null;
  } catch (error) {
    console.error(`Failed to fetch todo with id ${id} from D1 DB`, error);
    return null;
  }
};
```

ì´ì œ Honoì˜ Delete ë©”ì„œë“œë„ ëë‚¬ìœ¼ë‹ˆê¹Œ í´ë¼ì´ì–¸íŠ¸ìª½ì„ ì†ë´ì•¼í•©ë‹ˆë‹¤.

TodoItem ì»´í¬ë„ŒíŠ¸ì— Deleteë¥¼ ìœ„í•œ í¼ì„ ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.

```ts
// Todo Card
const TodoItem = ({ todo }: { todo: Todo }) => {
  const deleteFetcher = useFetcher();

  const [isCompleted, setIsCompleted] = useState(todo.completed);

  const isDeleting =
    deleteFetcher.state === "submitting" &&
    deleteFetcher.formData?.get("id") === todo.id.toString();

  const handleCheckboxChange = async (checked: boolean) => {
    await client.api.todos[":id"].$put({
      json: {
        title: todo.title,
        completed: isCompleted,
      },
      param: {
        id: todo.id.toString(),
      },
    });

    setIsCompleted(isCompleted === 0 ? 1 : 0);
  };

  return (
    <Card className="mb-4 hover:shadow-md transition-shadow duration-200">
      <CardContent
        className={`${isDeleting ? "bg-gray-300" : ""} flex items-center p-4`}
      >
        <Checkbox
          id={`todo-${todo.id}`}
          checked={isCompleted === 0 ? false : true}
          onCheckedChange={handleCheckboxChange}
          className="mr-4"
        />
        <div className="flex-grow">
          <label
            htmlFor={`todo-${todo.id}`}
            className={`${
              isDeleting ? "opacity-50" : "opacity-100"
            } text-lg font-medium leading-none ${
              isCompleted ? "line-through text-gray-400" : "text-gray-700"
            }`}
          >
            {todo.title}
          </label>
        </div>
        <div>
          <deleteFetcher.Form method="post">
            <input type="hidden" name="id" value={todo.id} />
            <Button
              type="submit"
              name="_action"
              value="delete"
              disabled={isDeleting}
            >
              {isDeleting ? "ì§€ìš°ëŠ” ì¤‘" : "ì§€ìš°ê¸°"}
            </Button>
          </deleteFetcher.Form>
        </div>
      </CardContent>
    </Card>
  );
};
```

UIë¥¼ ë³´ì‹œë©´ ì—¬ê¸°ì„œëŠ” Formì„ useFetcher í›…ìœ¼ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

Remix ê³ ê¸‰ ì‚¬ìš©ë²•ì¸ë°ìš”.

ì•„ê¹Œ create ìª½ì—ì„œëŠ” 'Form'ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

ê·¸ ë•Œ ì‚¬ìš©í•œ useNavigation í›…ê³¼ ê²¹ì¹˜ê¸° ë•Œë¬¸ì— useFetcherë¡œ ë”°ë¡œ 'Form'ì„ ë§Œë“¤ê¸° ìœ„í•œ Remixì˜ ê³ ê¸‰ ê¸°ë²•ì´ì£ .

ê·¸ëŸ°ë° ì˜ ë³´ì‹œë©´ deleteFetcher.Formì˜ methodê°€ "post"ì…ë‹ˆë‹¤.

ì™œëƒí•˜ë©´ action í•¨ìˆ˜ëŠ” post ë©”ì„œë“œë§Œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì‹¤ì œë¡œ action í•¨ìˆ˜ë¡œ ê°€ì‹œë©´ ì•„ë˜ì™€ ê°™ì´ ì•„ê¹Œ create í•  ë•Œ ì£¼ì„ì²˜ë¦¬í•œ ë¶€ë¶„ì„ ì£¼ì„ì„ ì§€ì›Œì£¼ì‹­ì‹œìš”.

```ts
export const action = async ({ request }: ActionFunctionArgs) => {
  const formData = await request.formData();
  const { _action, ...values } = Object.fromEntries(formData);

  if (_action === "delete") {
    await clientDeleteTodo(values);
  }

  if (_action === "create") {
    await clientCreateTodo(values);
  }

  return null;
};
```

ìœ„ì™€ ê°™ì´ action í•¨ìˆ˜ì—ì„œ clientDeleteTodo í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë¼ê³  í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ clientDeleteTodo í•¨ìˆ˜ë¥¼ ë³¼ê¹Œìš”?

```ts
export const clientDeleteTodo = async (values: any) => {
  await client.api.todos[":id"].$delete({
    param: {
      id: values.id as string,
    },
  });
};
```

ë¹™ê³ , ì—¬ê¸°ì„œ Honoì˜ $delete ì¦‰, DELETE ë©”ì„œë“œë¡œ í˜¸ì¶œë˜ê³  ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ê³  ë³´ë‹ˆ ì•„ê¹Œ completed í•­ëª©ì„ ì—…ë°ì´íŠ¸í•  ë•Œë„ apiClient í•¨ìˆ˜ìª½ì—ì„œ $putìœ¼ë¡œ í˜¸ì¶œí–ˆì—ˆë„¤ìš”.

Remixë¥¼ ì´ìš©í•  ë•ŒëŠ” PUT ë©”ì„œë“œì™€ DELETE ë©”ì„œë“œëŠ” ì´ëŸ° ì‹ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ useFetcherì˜ Formì„ ì´ìš©í•  ë•Œì˜ Pending UIëŠ” ì•„ë˜ì™€ ê°™ì´ í•˜ì‹œë©´ ì‰½ìŠµë‹ˆë‹¤.

```ts
const isDeleting =
    deleteFetcher.state === "submitting" &&
    deleteFetcher.formData?.get("id") === todo.id.toString();
```

ìœ„ ì½”ë“œëŠ” í¼ì´ submitting ë ë•Œ ê·¸ë¦¬ê³  ë‘ë²ˆì§¸ëŠ” í•´ë‹¹ delete ë˜ëŠ” ì•„ì´í…œë§Œ ì ìš©ì‹œí‚¤ê¸° ìœ„í•´ í•´ë‹¹ delete ë˜ëŠ” ì•„ì´í…œì˜ todo.id ê°’ê¹Œì§€ ì²´í¬í•˜ê²Œ í–ˆìŠµë‹ˆë‹¤.

ë§Œì•½ delete ë˜ëŠ” í•´ë‹¹ idê°’ì„ ì²´í¬í•˜ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ì•„ì´í…œì— Pending UIê°€ ì ìš©ë  ê²ë‹ˆë‹¤.

ì£¼ì˜í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³¼ê¹Œìš”?

![](https://blogger.googleusercontent.com/img/a/AVvXsEhsZCPt3clq6WndAdGc_x8ogVwcU_X8OaugwnJl9UJpmDjq6l99QAyVvJlMy327-sx_A5-jSp14WvofY_0B8I5mFcptXNgswg8zCIRX7O4wKtvbFQWacIJagnhi73DwvzwPhooRm3msOTzJa0skLmRgsiX78ETnBo7Qj2FRundf_dw1YjiVgvxzwQa4en4)

ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ Pending UIë„ ì˜ ì ìš©ë˜ê³  Deleteë„ ì˜ ë˜ê³  ìˆìŠµë‹ˆë‹¤.

---

## Cloudflareì— ë°°í¬í•˜ê¸°

ì´ì œ ëª¨ë“ ê²Œ ëë‚¬ìœ¼ë‹ˆê¹Œ ë¹Œë“œí›„ ë°°í¬í•´ì•¼ê² ë„¤ìš”.

```sh
$ npm run deploy

> deploy
> npm run build && wrangler pages deploy


> build
> remix vite:build

vite v5.4.8 building for production...
âœ“ 1654 modules transformed.
build/client/.vite/manifest.json                1.41 kB â”‚ gzip:  0.34 kB
build/client/assets/root-Cuu5eBUk.css          14.21 kB â”‚ gzip:  3.61 kB
build/client/assets/_index-MW916cbg.js          1.15 kB â”‚ gzip:  0.55 kB
build/client/assets/root-7GOmtebN.js            1.73 kB â”‚ gzip:  0.98 kB
build/client/assets/entry.client-C1Vo4Cp-.js    3.74 kB â”‚ gzip:  1.43 kB
build/client/assets/jsx-runtime-56DGgGmo.js     8.11 kB â”‚ gzip:  3.05 kB
build/client/assets/todos-LRAenMuD.js          42.29 kB â”‚ gzip: 14.90 kB
build/client/assets/components-CD3wXADJ.js    246.75 kB â”‚ gzip: 79.72 kB
âœ“ built in 1.77s
vite v5.4.8 building SSR bundle for production...
âœ“ 13 modules transformed.
build/server/.vite/manifest.json                0.22 kB
build/server/assets/server-build-Cuu5eBUk.css  14.21 kB
build/server/index.js                          16.87 kB
âœ“ built in 57ms
â–² [WARNING] Warning: Your working directory is a git repo and has uncommitted changes

  To silence this warning, pass in --commit-dirty=true


âœ¨ Compiled Worker successfully
ğŸŒ  Uploading... (11/11)

âœ¨ Success! Uploaded 8 files (3 already uploaded) (2.18 sec)

âœ¨ Uploading _headers
âœ¨ Uploading Functions bundle
âœ¨ Uploading _routes.json
ğŸŒ Deploying...
âœ¨ Deployment complete! Take a peek over at https://a651d0cf.hono-remix-test-5jr.pages.dev
```

ìœ„ì™€ ê°™ì´ deploy ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì•Œì•„ì„œ ë¹Œë“œí›„ Cloudflareì— ë°°í¬í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œ '.env' íŒŒì¼ì— API Endpointë¥¼ ìœ„í•œ ì£¼ì†Œë¥¼ ë„£ì–´ì•¼ í•˜ëŠ”ë°ìš”.

ìœ„ í„°ë¯¸ë„ ìƒì—ì„œ ë‚˜ì˜¤ëŠ” ì£¼ì†ŒëŠ” ë§¨ ì•ì— ë”ë¯¸ë¬¸ìì—´ í¬í•¨í•œ ì£¼ì†Œì¸ë°ìš”.

```sh
https://a651d0cf.hono-remix-test-5jr.pages.dev
```

ë”ë¯¸ë¬¸ìì—´ë§Œ ì§€ìš°ê³  ë‚˜ë©´ ì‹¤ì œ ì£¼ì†Œê°€ ë©ë‹ˆë‹¤.

```sh
https://hono-remix-test-5jr.pages.dev
```

ì´ì œ ì´ ì£¼ì†Œë¥¼ '.env'ì— ë„£ìœ¼ì‹œê³  ë‹¤ì‹œ deployí•˜ì‹œë©´ ë©ë‹ˆë‹¤.

```sh
VITE_API_URL=https://hono-remix-test-5jr.pages.dev/
```

```sh
$ npm run deploy
```

ì´ì œ Cloudflare ëŒ€ì‹œë³´ë“œë¡œ ê°€ ë³¼ê¹Œìš”?

![](https://blogger.googleusercontent.com/img/a/AVvXsEhtOuicy05Vsf91AMJFMNO6LBkjWudomSO9n_MZmvnpUENIa4rg1GgHR56q6Pcd3TS5yRoKSzQebwEH2j-BaHWdfgBExx3tVSKViTKrX6uHXlrxi3MZy1LtCL3chnkCIm7p9D5UxUeJCDnAGt4WRnI5siLaETt57WoHmANurSUotQiCgpWtQ5BAzGQLnhU)

ì˜ ë°°í¬ë˜ì—ˆë„¤ìš”.

ì´ì œ í•´ë‹¹ ì£¼ì†Œë¡œ ê°€ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¬ê²ë‹ˆë‹¤.

![](https://blogger.googleusercontent.com/img/a/AVvXsEhzffYxpio5MnCy1Y2_9rfj1bA3LAbmAFKUthwyE1BEnz2RmpfUE9ZvXY4r-7S1XKZhYV3rIzisROerKuTefEWhg4G_86g4ga1IS7ibrnS9xrppuV-tv97stcmzlDPdtEnQCiL1Z1I2tmV9M7-OByJw-u0_4sP1guLLaKYTvsswSAxmCxkh8Y0lFYxTypE)

ìš°ë¦¬ê°€ ì²˜ìŒì— Todos í…Œì´ë¸” ë§Œë“¤ ë•Œ ë”ë¯¸ê°’ìœ¼ë¡œ ë„£ì€ í•­ëª©ë§Œ ë‚˜ì˜¤ê³  ìˆë„¤ìš”.

ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ ì—¬ëŸ¬ë²ˆ í…ŒìŠ¤íŠ¸í•´ ë³´ì„¸ìš”.

![](https://blogger.googleusercontent.com/img/a/AVvXsEgUfNljBuibXCqamN4MAiRZ_x7jmn4t_dTPN2h1XsXSpwCnNIUITmTFlrVaM1exeiaAid4WWtcDLZTK-1Kw-klGgKQSCPBvxC7RHaoJQa0uy_f6WsQqswaKAyWj1yriktvTF0_fWhDfnU1ft68ukcyoSg_Wq00uDgk7abYIyfwpkAELMuOPvCBEOdGmJ-s)

![](https://blogger.googleusercontent.com/img/a/AVvXsEjq1kpZ8XaJXuhk2f55DMV4aChuVCnlGIUQR5hVAK9z552yI1MK3apC9uLE7TJoUB9qA9LMzfnaCDxRIbPL9kUdEeXV0EEXyt9pEcWXQGDY1yNsz1GpYVGsBMf1J_25CbMyXe0oDeIMpixxOJIX2b1ZYp3XtoXEL7p5H15nIHAksKDgVqZm8uzb2bvnTgU)

ìœ„ ë‘ê°œì˜ ê·¸ë¦¼ìœ¼ë¡œ ë³´ì‹œë‹¤ì‹œí”¼ create, delete ëª¨ë‘ Pending UIê¹Œì§€ ì™„ë²½í•˜ê²Œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´ì œ ë‹¤ ëë‚¬ë„¤ìš”.

ì–´ë–¤ê¹Œìš”?

Remixì™€ Honoì˜ ì¡°í•©!

ì €ëŠ” ê°œì¸ì ìœ¼ë¡œ Cloudflare Pagesë¥¼ ì¢‹ì•„í•˜ëŠ”ë°ìš”.

ë¬´ë£Œì— D1 DB, KVê¹Œì§€ ì‚¬ìš©í•  ìˆ˜ ìˆê³  Workerê¹Œì§€ ë§Œë“¤ ìˆ˜ ìˆì–´ ì•„ì£¼ ì¢‹ìŠµë‹ˆë‹¤.

ì´ì œ Remixì™€ Honoë¥¼ ì´ìš©í•´ì„œ FullStack ì•±ë§Œ ë§Œë“¤ë©´ ë˜ê² ë„¤ìš”.

ê·¸ëŸ¼.

